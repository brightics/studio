/*   Brightics VA Build 190718 */(function(){"use strict";var t,e=this.Brightics.VA.Core.Functions.Library;this.Brightics.VA.Implementation.DataFlow={Clazz:"data",Label:"Data Flow",Launcher:{},Validator:{},Editors:{Diagram:{},Sheet:{Panels:{Properties:{}}},Header:{},BodyContainer:{}},Dialogs:{RefineSteps:{Validator:{}}},Tools:{Adapter:{},Manager:{}},Utils:{}},this.Brightics.VA.Implementation.DataFlow.Functions=e.extendFunctions(["load","dbReader","unload","cassandraLoad","cassandraUnload","randomDataGeneration","ewma","imputeDatetime","imputeNumberTypeFillColumn","imputeStringTypeFillColumn","kalmanFilter","movingAverage","dataNormalization","sort","timeShift","timeSeriesDistance","conditionalUpdate","elementwiseProduct","polynomialExpansion","polynomialRegressionTrain","polynomialRegressionPredict","distinctFilter","conditionFilter","minmaxFilter","imputeRemoveLine","lengthFilter","outlierRemoval","stringFilter","independentFilter","correlation","quantileDiscretizer","frequency","frequencyMat","statisticDerivation","statisticSummary","kernelDensityEstimation","kernelDensity","gaussianMixtureTrain","gaussianMixturePredict","chiSquareTest","duncanTest","ttest","typeCast","changeColumnName","capitalizeColName","reorganizeTable","join","colAppend","rowAppend","powerRowAppend","queryExecutor","pivot","unpivot","stratifiedSampling","randomSampling","timeSeriesTranspose","splitData","refine","qrDecomposition","pca","indexToString","transpose","bucketizer","mdRemove","mdReplaceNumber","mdReplaceString","mdTrim","mdCapitalize","mdLength","numericalVariableDerivation","rowIndexDerivation","conditionalDerivation","ymdhwFromDatetime","datetimeFormatConvertor","datetimeCalculator","oneHotEncoder","stringIndexer","vectorIndexer","binarizer","nGram","stringSplit","addLeadLag","autoArimaTrain","autoArimaPredict","arimaTrain","arimaPredict","linearRegressionTrain","linearRegressionPredict","logisticRegressionTrain","logisticRegressionPredict","timeSeriesLRTrain","timeSeriesLRPredict","holtWintersTrain","holtWintersPredict","isotonicRegressionTrain","isotonicRegressionPredict","glm","glmForLogisticRegression","glmPredict","glmPredictForLogisticRegression","alsTrain","alsRecommend","decisionTreeTrain","decisionTreePredict","decisionTreeCartTrain","decisionTreeCartPredict","kmeans","knn","naiveBayesTrain","naiveBayesPredict","hierarchicalClustering","hierarchicalClusteringPostProcess","svmTrain","svmPredict","svd","randomForestTrain","randomForestPredict","latentDirichletAllocation","powerIterationClustering","oneVsRestLRClassifierTrain","oneVsRestLRClassifierPredict","anova","regressionEvaluation","binaryClassificationEvaluation","multiclassClassificationEvaluation","csp","outDet","calib","logLikelihoodRatioTest","logLikelihoodRatioTestForLR","evaluateRankingAlgorithm","elasticIndexing","elasticSearch","elasticRegExpSearch","elasticQueryExecutor","scalaScript","pythonScript","rGroupBy","rScript","flatMapR","rScript2","mlpPredict","mlpTrain","dlPredict","sqlExecutor","addColumnByRefine","selectColumn","tFIDF","changeValue","groupBy","simpleFilter","advancedFilter","sortByRefine","linearUCBTrain","linearUCBPrescribe","associationRule","featureEncoding","columnsToArray","arrayToColumns","bigDataScatter","bigDataLine","bigDataColumn","bigDataBar","bigDataBoxPlot","bigDataPie","bigDataHistogram","qLearningTrain","qLearningPrescribe","sarsaTrain","sarsaPrescribe","thompsonSamplingTrain","thompsonSamplingPrescribe","valueIterationTrain","valueIterationPrescribe","interactivePrediction","tokenizer","chiSqSelection","createTable","correlationWithPivot","timeSeriesAnalysis","eDA","optPreprocessing","localOptimization","globalOptimization","parameterStudies","designOfExperiments","sampling","uncertaintyQuantification","randomSplit","unknownFunction","flow","if","forLoop","whileLoop","import","export","setValue","dataViewer","udfTest","kmeanspy","kmeansmodelpy","pairwisescatter","kmeans2","kmeans2model","testftn1","testftn2","testftn3","unpivot","pythonRefine","timeSeriesSmoothen","timeSeriesDecomposition","crossCorrelation","autoCorrelation","aRXTrain","aRXPredict","tFIDF","stopWordsRemover","vIF","twoSampleTTestForStacked","trimmedMeansOneWayTest","stringSummary","pairedTTest","oneSampleTTest","normalityTest","mannWhitneyUTest","levenesTest","kruskalWallisHTest","fTestForStacked","crossTable","correlationTest","chiSquareTestOfIndependence","chiSquareTestForGivenProportions","chiSqTestForTheVariance","bootstrapLimit","bartlettsTestForStacked","stepwiseLinearRegressionTrain","stepwiseLinearRegressionPredict","predictor","polynomialRegressionTrain","polynomialRegressionPredict","linearRegressionResidual","mahalanobisDistanceOutlierDetection","exportColumn","oneHotEncoderModel","oneHotEncoder","labelIndexerModel","labelIndexer","indexToLabelModel","indexToLabel","evaluateTimeSeries","sVMRBFTrain","sVMRBFPredict","sVMRBF","symbolicRegressionTrain","symbolicRegressionPredict","randomForestRegressionTrain","randomForestRegressionPredict","randomForestClassificationTrain","randomForestClassificationPredict","gBTRegressionTrain","gBTRegressionPredict","gBTClassificationTrain","gBTClassificationPredict","decisionTreeRegressionTrain","decisionTreeRegressionPredict","decisionTreeClassificationTrain","decisionTreeClassificationPredict","autoRegressionTrain","autoRegressionPredict","autoOneVsRestLogisticRegressionTrain","autoMLPTrainForClassification","autoLogisticRegressionTrain","autoLogisticRegressionPredict","autoLinearRegressionTrain","autoLinearRegressionPredict","autoFeatureSelection","autoDataCleansing","autoClassificationTrain","autoClassificationPredict","bootstrapLimit","t2train","t2predict","sprt","sbmtrain","sbmpredict","adRandomForestTrain","adRandomForestPredict","adPoissonFilter","readFromS3","writeToS3","readFromDb","writeToDb","addColumnIfPython","simpleFilterPython","advancedFilterPython","selectColumnPython","sortPython","addColumnPython","dialogProperties","merge","addFunctionColumnsPython","brightics.function.evaluation$plot_roc_pr_curve","queryExecutorPython","createTablePython"]),this.Brightics.VA.Implementation.DataFlow.Helpers={sqlfunctionhelp:{label:"SQL Function Help",operation:"SQLFuncHelper"}},this.Brightics.VA.Implementation.DataFlow.defaultModel=$.extend(!0,((t={variables:{},variableRef:[],innerModels:{},getVariableAssignedParamList:function getVariableAssignedParamList(t){for(var e=[],i=0;i<this.variableRef.length;i++){var a=this.variableRef[i];for(var r in a.param){a.param[r]===t&&e.push({fid:a.fid,param:r});}}return e;},renameVariableKey:function renameVariableKey(t,e){if(this.variables[e])throw new Error("variable already exists");this.variables[e]=this.variables[t],delete this.variables[t];},updateVariable:function updateVariable(t,e,i){if(!this.variables[t])throw new Error("variable not exists");this.variables[t].type=e,this.variables[t].value=i;},getInnerModel:function getInnerModel(t){return(this.innerModels||{})[t];},getInnerModels:function getInnerModels(t){return this.innerModels=this.innerModels||{},this.innerModels;},addInnerModel:function addInnerModel(t){return this.innerModels=this.innerModels||{},this.innerModels[t.mid]=t,t;},removeInnerModel:function removeInnerModel(t){var e=this.innerModels[t];return delete this.innerModels[t],e;},removeInnerModelRecursion:function removeInnerModelRecursion(t){var e=this,i=this.innerModels[t],a=[];if(i){var r=i.functions;(a=a.concat(_.map(r,function(t){var i=Brightics.VA.Core.Utils.NestedFlowUtils.getSubModels(e,t);return _.map(i,function(t){return e.removeInnerModelRecursion(t.mid);});}))).push(e.removeInnerModel(t));}return _.filter(_.flattenDeep(a),_.negate(_.isUndefined));}})[IN_DATA]=[],t[OUT_DATA]=[],t),Brightics.VA.Default.analyticsModel),this.Brightics.VA.Implementation.DataFlow.innerModel=$.extend(!0,function(){var t={};return t[IN_DATA]=[],t[OUT_DATA]=[],t;}(),Brightics.VA.Default.analyticsModel);}).call(this),function(){"use strict";var t=this.Brightics,e=brtc_require("TabChannel");function i(e,i){t.VA.Core.Editors.ModelEditor.call(this,e,i),this.initUDFChangeListener(),this.initTemplateChangeListener(),this.initTabChannel();}i.prototype=Object.create(t.VA.Core.Editors.ModelEditor.prototype),i.prototype.constructor=i,i.prototype.createPanelFactory=function(){this.panelFactory=new t.VA.Implementation.DataFlow.Editors.Sheet.PanelFactory();},i.prototype.addToLibrary=function(e){var i=this;new t.VA.Core.Dialogs.AddToLibraryDialog(this.$mainControl,{close:function close(t){if(t.OK){var a={library_id:t.library,label:t.label,contents:e,description:""};i.modelLayoutManager.handleAppendTemplate(a);}},title:"Add to Template"});},i.prototype.addToFunctionClipboard=function(t){if(t.functions.length>0){var e={width:$(".brtc-va-editors-diagram-diagrameditorpage-function-multiselected").width(),height:$(".brtc-va-editors-diagram-diagrameditorpage-function-multiselected").height(),contents:t};Studio.getClipboardManager().addFunctionToClipboard(e);}},i.prototype.initUDFChangeListener=function(){var t=this;this.$mainControl.bind("udfChanged",function(e,i){t.fireUDFChanged(i);});},i.prototype.initTemplateChangeListener=function(){var t=this;this.$mainControl.bind("templateChanged",function(e,i){t.fireTemplateChanged(i);});},i.prototype.initTabChannel=function(){var i=this;i.tabChannel=new e(Date.now()),i.tabChannel.listen("multi-chart",function(e){return i.getCommandManager().execute(new t.VA.Core.Editors.Diagram.Commands.UpdateMultiChartOptionCommand(i,{fid:e.value.fid,cid:e.value.cid,value:e.value.multiChartOption})),{success:!0};});},i.prototype.fireUDFChanged=function(t){this.modelLayoutManager.handleUDFChanged(t);},i.prototype.fireTemplateChanged=function(t){this.modelLayoutManager.handleTemplateChanged(t);},i.prototype.preProcess=function(e){var i=e||{},a=this.getEditorInput().getProjectId(),r=this.getModel();return t.VA.Core.Utils.NestedFlowUtils.makeRunnable(a,r,i).then(function(t){return t;}).catch(console.error);},i.prototype.getConnectionKey=function(){return this.tabChannel.getConnectionKey();},t.VA.Implementation.DataFlow.Editor=i;}.call(this),function(){"use strict";var t=this.Brightics;function e(e,i){t.VA.Core.Editors.ModelLayoutManager.call(this,e,i),this.registerCommandManagerListener(),this.getToolbar().navigator.registerOpenNavigatorDialog(this.openNavigatorDialog.bind(this));}e.prototype=Object.create(t.VA.Core.Editors.ModelLayoutManager.prototype),e.prototype.constructor=e,e.prototype.registerConditionHeader=function(t){this.conditionHeader=t,this.conditionHeader.on("tab-click",function(t){this.changeEditorModel(t.data.getId());}.bind(this));},e.prototype.registerLoopHeader=function(t){this.loopHeader=t;},e.prototype.changeEditorModel=function(t){this.getEditor().setActiveModel(t),this.getDiagramEditorWrapper().setModel(this.getEditor().getActiveModel(),this.fnUnit),this.getToolbar().navigator.buildNavigator(t,this.fnUnit.fid),this.getEditor().resetSheetEditorPage(),this.getSideBarManager().onModelChange(),this.getDiagramEditorPage().createExpressionControl(),this.adjustLayout();},e.prototype.openActivity=function(t,e){this.fnUnit=e,this.getToolbar().navigator.buildNavigator(t,e?e.fid:void 0),this.getEditor().setActiveModel(t),this.getDiagramEditorWrapper().setModel(this.getEditor().getActiveModel(),e),this.getEditor().resetSheetEditorPage(),this.getSideBarManager().onModelChange(),this.getDiagramEditorPage().createExpressionControl(),this.adjustLayout();},e.prototype.setDiagramHeight=function(){var t=this.getEditor().getDiagramArea(),e=this.$editor.height()-this.getToolbar().getHeight(),i=this.getEditor().getHeaderArea(),a="none"!==i.css("display")?i.height():0;t.height(e-a),this.handleExpandStatusChanged();},e.prototype.handleAppendTemplate=function(t){this.getSideBarManager().getSideBars().palette.appendTemplate(t);},e.prototype.handleSelectFunction=function(t){this.getDiagramEditorPage().selectFunction(t);},e.prototype.handleChangeScale=function(t){this.getDiagramEditorPage().changeScale(t);},e.prototype.handleChangeTooltipEnabled=function(t){this.getDiagramEditorPage().changeTooltipEnabled(t);},e.prototype.handleFitToContent=function(){this.getDiagramEditorPage().fitToContent();},e.prototype.handleOpenHistoryDialog=function(e){var i,a=this,r=$(e.target).offset(),o={x:r.left-402+26,y:r.top-10+40},n=this.getEditor().getCommandManager().getStacks(),s=[];for(var l in n){i=n[l].option&&n[l].option.fnUnit?n[l].getLabel()+" - "+n[l].options.fnUnit.display.label:n[l].getLabel(),s.push({name:n[l].getLabel(),description:i});}this.getEditor().setHistorySelector(new t.VA.Core.Dialogs.HistorySelector(this.getEditor().$mainControl,{selectHistory:function selectHistory(t){t.OK&&(a.getEditor().getCommandManager().go(t.goHistory),a.getEditor().setEnableRedoUndoButton(),a.getEditor().refreshRedoUndoLabel());},stackIndex:a.getEditor().getCommandManager().getIndex(),pos:o,source:s,editor:a.getEditor()}));},e.prototype.handleOpenIndexDialog=function(e){var i=$(e.target).offset(),a={x:i.left-402+26,y:i.top-10+40};this.getEditor().indexDialog=new t.VA.Core.Dialogs.IndexDialog(this.getEditor().$mainControl,{editor:this.getEditor(),window:{position:a},appendTo:this.getEditor().$mainControl});},e.prototype.openNavigatorDialog=function(e,i,a){this.getEditor().navigatorDialog&&this.getEditor().navigatorDialog.close(),this.getEditor().navigatorDialog=new t.VA.Core.Dialogs.NavigatorDialog(this.getEditor().$mainControl,_.merge({editor:this.getEditor(),window:{position:e},appendTo:this.getEditor().$mainControl},a));},e.prototype.handleOpenScheduleManagementDialog=function(){new t.VA.Core.Dialogs.ScheduleManagementDialog(this.getEditor().$mainControl,{editorInput:this.getEditor().getModel(),appendTo:this.getEditor().$parent,title:"Schedule list"});},e.prototype.handleExpandStatusChanged=function(){this.setEditorWidth();},e.prototype.setEditorWidth=function(){var t=this.getSideBarManager();if(t){var e=this.getEditor().getMainArea().find(".brtc-va-editors-modeleditor-splitter"),i=this.editor.getLeftTabBarArea().height(),a=t.getLeftSideBarWidth()+t.getRightSideBarWidth();t.isOpen("left")&&(a+=i),t.isOpen("right")&&(a+=i);var r=t.isOpen("left")?t.getLeftSideBarWidth()+i:i;e.css("width","calc(100% - "+a+"px)").css("margin-left",r);var o=this.getEditor().getHeaderArea(),n=40+o.outerHeight();e.css("height","calc(100% - "+n+"px)"),o.css("width","calc(100% - "+a+"px)").css("margin-left",r),this.getSheetEditorPage().getFnUnitViewer().updatePanelWidth();}},e.prototype.getFnUnit=function(){return this.fnUnit;},e.prototype.registerCommandManagerListener=function(){var t=this,e=this.getEditor().getCommandManager();e.registerCallbackLeft(function(e){var i=e.options.editorContext.fnUnit,a=e.options.editorContext.mid;"Remove Condition"===e.options.label&&a===e.options.mid&&(a=i.param.if.mid),t.fnUnit===i&&a===t.getEditor().getActiveModel().mid||t.openActivity(a,i),t.getSideBarManager().onModelChange(e);}),e.registerGoHistoryCallbackLeft(function(e){var i=e.options.commands,a=i[i.length-1],r=a.options.editorContext.fnUnit,o=a.options.editorContext.mid;"Remove Condition"===a.options.label&&o===a.options.mid&&(o=r.param.if.mid),t.fnUnit===r&&o===t.getEditor().getActiveModel().mid||t.openActivity(o,r),t.getSideBarManager().onModelChange();});},e.prototype.getDiagramEditorPage=function(){return this.editor.getDiagramEditorPage();},e.prototype.getSheetEditorPage=function(){return this.editor.getSheetEditorPage();},e.prototype.getDiagramEditorWrapper=function(){return this.editor.getDiagramEditorWrapper();},e.prototype.handleOnActivate=function(){this.getDiagramEditorPage().onActivated(),this.getSideBarManager().onActivated(),this.getSheetEditorPage().onActivated();},e.prototype.destroy=function(){this.getSheetEditorPage().destroy(),this.getDiagramEditorPage().destroy();},t.VA.Implementation.DataFlow.ModelLayoutManager=e;}.call(this),function(){"use strict";var t=this,e=t.Brightics;function i(t){this.validator={},this.options=t||{};}i.prototype.validate=function(t){var e=[];for(var i in t.functions){var a=t.functions[i];try{var r,o=this.createValidator(a.func);o&&(r=o.validate(a,t)),r&&(e=e.concat(r));}catch(t){console.log(t);}}return e=e.filter(function(t){return void 0!==t&&null!=t;}),t.problemList=e,t.problemList;},i.prototype.createValidator=function(i){var a=void 0===t.Brightics.VA.Implementation.DataFlow.Functions[i]?t.Brightics.VA.Implementation.DataFlow.Functions.unknownFunction.validator:t.Brightics.VA.Implementation.DataFlow.Functions[i].validator;return this.validator[i]?this.validator[i]:this.validator[i]=a?new a():new e.VA.Core.Validator.BaseValidator();},e.VA.Implementation.DataFlow.Validator=i;}.call(this),function(){"use strict";var t=this.Brightics;function e(){this._functionContents=this._getContents(),this._validatorParams=this._functionContents.params||[],t.VA.Core.Validator.SingleInputValidator.call(this);}e.prototype=Object.create(t.VA.Core.Validator.SingleInputValidator.prototype),e.prototype.constructor=e,e.prototype.initRules=function(){this.addLinkRule(),this.addInTableRule(),this.addRulesFromParams(),this._createCustomValidation();},e.prototype.addLinkRule=function(){var t=this,e=this.FnUnitUtils.getTotalInRangeCount(this._functionContents);void 0!==e&&0!=e.min&&this.addRule(function(e){return t.checkLinkIsConnected(e);});},e.prototype.addInTableRule=function(){var t=this;this.addRule(function(e){if(!t.FnUnitUtils.hasMeta(e)||t.FnUnitUtils.hasTable(e))return t.checkInTableIsEmpty(e);});},e.prototype._createCustomValidation=function(){for(var t,e=0;e<this._validatorParams.length;e++){(t=this._validatorParams[e]).validation&&t.validation.length>0&&this._addCustomRule(t);}},e.prototype.addColumnsRule=function(){var t=this;this.addRule(function(e){if(!t.checkLinkIsConnected(e))return t.checkColumnIsEmpty(e,"columns",e.param.columns[0],"Columns");}),this.addRule(function(e){if(!t.checkLinkIsConnected(e))return t.checkColumnExists(e,"columns",e.param.columns[0]);});},e.prototype._addCustomRule=function(t){for(var e,i=this,a=t.validation,r=t.id,o=0;o<a.length;o++){e=a[o],this.addRule(function(t){if(!i.checkLinkIsConnected(t)){var a=new Function("value","fnUnit",e.validationCode),o=$.extend(!0,{},t);if(t.param[r]&&!1===a.call(i,t.param[r],o)){var n={errorCode:e.messageCode||"BR-0100",param:r,messageParam:e.messageParam};return i.problemFactory.createProblem(n,t);}}});}},e.prototype.addRulesFromParams=function(){for(var t,e=0;e<this._validatorParams.length;e++){!0===(t=this._validatorParams[e]).mandatory&&this._createMandatoryRule(t);}},e.prototype._createMandatoryRule=function(t){var e=this,i=t.id,a=t.label,r=t.type;"ColumnSelector"===t.control?(this.addRule(function(t){if(!e.checkLinkIsConnected(t))return e.checkColumnIsEmpty(t,i,t.param[i],a);}),this.addRule(function(t){if(!e.checkLinkIsConnected(t))return e.checkColumnExists(t,i,t.param[i]);})):"InputBox"===t.control?this.addRule(function(t){if(!e.checkLinkIsConnected(t))return e.emptyProblemMessage(t,i,t.param[i],a);}):"DropDownList"===t.control?this.addRule(function(t){if(!e.checkLinkIsConnected(t))return e.emptyProblemMessage(t,i,t.param[i],a);}):"RadioButton"===t.control||("CheckBox"===t.control?this.addRule(function(t){if(!e.checkLinkIsConnected(t)){var r={errorCode:"BR-0033",param:i,messageParam:[a]};return e._checkArrayIsEmpty(r,t,t.param[i]);}}):"Expression"===t.control?this.addRule(function(t){if(!e.checkLinkIsConnected(t))return e.emptyProblemMessage(t,i,t.param[i],a);}):"ArrayInput"===t.control&&this.addRule(function(t){if(!e.checkLinkIsConnected(t)){var o={errorCode:"BR-0033",param:i,messageParam:[a]};return e._checkArrayIsCompact(o,t,t.param[i],a,r);}}));},t.VA.Implementation.DataFlow.Functions.InvokeValidator=e;}.call(this),function(){"use strict";var t=this.Brightics;function e(){t.VA.Core.ModelLauncher.call(this),this.isProcessing=!1;}e.prototype=Object.create(t.VA.Core.ModelLauncher.prototype),e.prototype.constructor=e,e.prototype.launchUnit=function(e,i,a,r){this.isProcessing||(this.isProcessing=!0,this.__launchUnit=this.__launchUnit||_.debounce(function(e,i,a,r){var o=this,n=this._generateJobId(e.fid),s=t.VA.Env.Session.userId;t.VA.Core.Utils.RunnableFactory.createForUnit(e,n,s,i,a).then(function(i){var n={mode:"unit",clazz:t.VA.Implementation.DataFlow.Clazz,originalModels:[e.parent()],expectedUnitCount:1,runnable:i};o._launch(n,a,r);}).catch(function(){o.isProcessing=!1;});}.bind(this),1e3,{leading:!0,trailing:!1}),this.__launchUnit(e,i,a,r));},e.prototype.launchModel=function(e,i,a,r){this.isProcessing||(this.isProcessing=!0,this.__launchModel=this.__launchModel||_.debounce(function(e,i,a,r){var o=this,n=e.mid,s=this._generateJobId(n),l=t.VA.Env.Session.userId,c=e.functions.length;t.VA.Core.Utils.RunnableFactory.createForFlow(e,s,l,i,a).then(function(i){var n={mode:"data-flow",clazz:t.VA.Implementation.DataFlow.Clazz,originalModels:[e],expectedUnitCount:c,runnable:i};o._launch(n,a,r);}).catch(function(){o.isProcessing=!1;});}.bind(this),1e3,{leading:!0,trailing:!1}),this.__launchModel(e,i,a,r));},e.prototype._launch=function(e,i,a){var r=this,o=new t.VA.Implementation.DataFlow.EventDetector(e),n=function n(t){for(var e in t.processes){var a=t.processes[e],n=a.pid||"pid_undefined",s=a.mid,l=o.createProcessEvent(n,s,a.begin,a.end,a.status,e);for(var c in a.functions){var d=a.functions[c];"PROCESSING"==d.status&&(r.processingUnit=d),l=l.concat(o.createUnitEvent(n,s,d,c));}for(var p in l){l[p].originalResponse=t;}i&&i.hideDialog||r._fireEvents(l);}},s=function s(t){var a={eventType:"END-JOB",jid:t.jobId,message:r._getProcessingMessage(t),detailMessage:r._getProcessingDetailMessage(t),status:t.status,launchOptions:e,originalResponse:t};i&&i.hideDialog||r._fireEvents([a]),delete r.jobScheduler[t.jobId],r.isProcessing=!1;},l={status:[function(t){n(t);}],success:[function(t){n(t),s(t);}],abort:[function(t){s(t);}],fail:[function(t){n(t),s(t);}],pending:[function(t){!function(t){var a={eventType:"PENDING-JOB",jid:t.jobId,message:r._getPendingMessage(t),status:t.status,launchOptions:e,originalResponse:t};i&&i.hideDialog||r._fireEvents([a]);}(t);}],catch:[function(t){s({jobId:e.runnable.jid,status:"FAIL",exception:t});}]};this._extendListeners(l,a);var c=new t.VA.Implementation.DataFlow.Job(l);c.start(e.runnable).then(function(t){var a=t.result;r.jobScheduler[a]=c;var o={eventType:"BEGIN-JOB",jid:a,status:"WAIT",launchOptions:e};i&&i.hideDialog||r._fireEvents([o]);});},t.VA.Implementation.DataFlow.DataFlowLauncher=e;}.call(this),function(){"use strict";var t=this.Brightics;function e(t){this.cache={},this.labelMap={},this.subflowMap={},this.innerModelMap={},this.launchOptions=t;var e=this.launchOptions.runnable.models;for(var i in e){var a=e[i];this._scanModel(i,a);}}e.prototype._scanModel=function(t,e,i){var a=t+"_pid";this.labelMap[a]=e.title,this._scanFunctions(t,e,i);var r=e.innerModels;for(var o in r){var n=r[o];this._scanModel(o,n,t);}},e.prototype._scanFunctions=function(t,e,i){i&&(t=i);for(var a=0;a<e.functions.length;a++){var r=e.functions[a],o=t+"_"+r.fid;if(this.labelMap[o]=r.label,"Subflow"==r[FUNCTION_NAME]&&r.param.functions.length>0){var n={fid:r.fid,first:r.param.functions[0].fid,last:r.param.functions[r.param.functions.length-1].fid};for(var s in r.param.functions){var l=r.param.functions[s];this.subflowMap[t+"_"+l.fid]=n;}}else if("ForLoop"==r[FUNCTION_NAME]||"WhileLoop"==r[FUNCTION_NAME]||"If"==r[FUNCTION_NAME]){var c=r.label,d=r.param.mid;this.innerModelMap[d]=c;}else r.param.functions&&this._scanFunctions(t,r.param,r.fid);}},e.prototype.createUnitEvent=function(t,e,i,a){var r,o=[];return(r=this._createUnitStartEvent(t,e,i,a))&&o.push(r),(r=this._createUnitEndEvent(t,e,i,a))&&o.push(r),o;},e.prototype._createUnitStartEvent=function(t,e,i,a){if(this.cache[t]&&!(i.fid.indexOf("internal_function")>-1)){var r,o=i.fid,n=this.subflowMap[e+"_"+i.fid];if(r=n?o=n.fid:o+"@"+a,"WAIT"!==i.status&&!this.cache[t][r]){var s={eventType:"BEGIN-UNIT",launchOptions:this.launchOptions,pid:t,mid:e,fid:o,status:"PROCESSING",label:this.labelMap[e+"_"+o],begin:i.begin,message:i.message,sequence:a};return i.fid.indexOf("read_alluxio_pagination")>-1?s.label="(read)":i.fid.indexOf("write_alluxio_pagination")>-1&&(s.label="(write)"),this.cache[t][r]={event:s},s;}if(this.cache[t][r]&&(this.cache[t][r].event.begin!=i.begin||"SUCCESS"==this.cache[t][r].event.status)){s={eventType:"BEGIN-UNIT",launchOptions:this.launchOptions,pid:t,mid:e,fid:o,status:"PROCESSING",label:this.labelMap[e+"_"+o],begin:i.begin,message:i.message,sequence:a};return i.fid.indexOf("read_alluxio_pagination")>-1?s.label="(read)":i.fid.indexOf("write_alluxio_pagination")>-1&&(s.label="(write)"),this.cache[t][r]={event:s},s;}if(this.cache[t][r]&&(this.cache[t][r].event.begin!=i.begin||"PROCESSING"==this.cache[t][r].event.status)){s={eventType:"UPDATE-UNIT",launchOptions:this.launchOptions,pid:t,mid:e,fid:o,status:"PROCESSING",label:this.labelMap[e+"_"+o],begin:i.begin,message:i.message,sequence:a};return i.fid.indexOf("read_alluxio_pagination")>-1?s.label="(read)":i.fid.indexOf("write_alluxio_pagination")>-1&&(s.label="(write)"),this.cache[t][r]={event:s},s;}if(this.cache[t][r]&&(this.cache[t][r].event.begin!=i.begin||"SUCCESS"==this.cache[t][r].event.status)){s={eventType:"BEGIN-UNIT",launchOptions:this.launchOptions,pid:t,mid:e,fid:o,status:"PROCESSING",label:this.labelMap[e+"_"+o],begin:i.begin,sequence:a};return i.fid.indexOf("read_alluxio_pagination")>-1?s.label="(read)":i.fid.indexOf("write_alluxio_pagination")>-1&&(s.label="(write)"),this.cache[t][r]={event:s},s;}if(this.cache[t][r]&&(this.cache[t][r].event.begin!=i.begin||"SUCCESS"==this.cache[t][r].event.status)){s={eventType:"BEGIN-UNIT",launchOptions:this.launchOptions,pid:t,mid:e,fid:o,status:"PROCESSING",label:this.labelMap[e+"_"+o],begin:i.begin,sequence:a};return i.fid.indexOf("read_alluxio_pagination")>-1?s.label="(read)":i.fid.indexOf("write_alluxio_pagination")>-1&&(s.label="(write)"),this.cache[t][r]={event:s},s;}}},e.prototype._createUnitEndEvent=function(t,e,i,a){var r,o=i.fid,n=this.subflowMap[e+"_"+i.fid];if(r=n?o=n.fid:o+"@"+a,this.cache[t]&&this.cache[t][r]&&"PROCESSING"==this.cache[t][r].event.status&&this.cache[t][r].event.status!=i.status)return this.cache[t][r].event.status=i.status,{eventType:"END-UNIT",launchOptions:this.launchOptions,pid:t,mid:e,fid:o,status:i.status,label:this.labelMap[e+"_"+o],begin:i.begin,end:i.end,message:i.message,sequence:a};},e.prototype.createProcessEvent=function(t,e,i,a,r,o){var n,s=[];return(n=this._createProcessStartEvent(t,e,i,o))&&s.push(n),(n=this._createProcessEndEvent(t,e,i,a,r))&&s.push(n),s;},e.prototype._createProcessStartEvent=function(t,e,i,a){if(!(e.indexOf("internal_process")>-1||this.cache[t]&&"0"==a)){var r={eventType:"BEGIN-PROCESS",launchOptions:this.launchOptions,pid:t,mid:e,label:this.labelMap[t],status:"PROCESSING",begin:i};return this.cache[t]={mid:r.mid,status:r.status},r;}},e.prototype._createProcessEndEvent=function(t,e,i,a,r){if(this.cache[t]&&"PROCESSING"==this.cache[t].status&&this.cache[t].status!=r)return{eventType:"END-PROCESS",launchOptions:this.launchOptions,pid:t,mid:e,label:this.labelMap[t],status:r,begin:i,end:a};},t.VA.Implementation.DataFlow.EventDetector=e;}.call(this),function(){"use strict";var t=this.Brightics;function e(e){t.VA.Core.JobDelegator.call(this,e),this.runnable=null,this._abort=!1;}e.prototype=Object.create(t.VA.Core.JobDelegator.prototype),e.prototype.constructor=e,e.prototype._start=function(t){var e={url:"api/va/v2/analytics/jobs/execute",data:JSON.stringify(t),type:"POST",contentType:"application/json; charset=utf-8",blocking:!1};return Promise.resolve($.ajax(e)).then(function(t){return JSON.parse(t);});},e.prototype._stop=function(t){var e={url:"api/va/v2/analytics/jobs/"+this.jobId+"/delete",type:"POST",blocking:!1,contentType:"application/json; charset=utf-8"};if(t){var i={type:t};e.data=JSON.stringify(i);}return $.ajax(e);},e.prototype._check=function(t){var e={url:"api/va/v2/analytics/jobs/"+t,type:"GET",blocking:!1};return $.ajax(e);},e.prototype._scheduleCheckStatus=function(t){var e=this,i=function i(){e._check(t).done(function(a){e._abort?e._fireAbort({jobId:t,end:Date.now(),status:"ABORT",message:"Job aborted by user"}):"FAIL"===a.status?e._fireFail(a):"SUCCESS"===a.status?e._fireSuccess(a):"WAIT"===a.status?(e._firePending(a),setTimeout(i,500)):(e._fireStatus(a),setTimeout(i,500));}).fail(e._fireCatch.bind(e));};setTimeout(i,500);},e.prototype.start=function(t){var e=this;return this.runnable=t,this._start(t).then(function(t){return e.jobId=t.result,e._scheduleCheckStatus(t.result),t;},e._fireCatch.bind(e));},e.prototype.stop=function(t){this._stop(t),this._abort=!0;},t.VA.Implementation.DataFlow.Job=e;}.call(this),function(){"use strict";function t(t,e){Brightics.VA.Core.Editors.Diagram.DiagramEditorPage.call(this,t,e);}t.prototype=Object.create(Brightics.VA.Core.Editors.Diagram.DiagramEditorPage.prototype),t.prototype.constructor=t,Brightics.VA.Implementation.DataFlow.Editors.Diagram.EditorPage=t;}.call(this),function(){"use strict";var t=this.Brightics;function e(){}e.prototype=Object.create(t.VA.Core.Editors.Sheet.PanelFactory.prototype),e.prototype.constructor=e,e.prototype.createInDataPanel=function(e,i){if(i.fnUnit[IN_DATA]){i.title=i.title||"In",i.resizable=!!i.fnUnit[OUT_DATA];var a=i.fnUnit.func,r=t.VA.Core.Editors.Sheet.Panels.DataPanel;return"export"===a&&(r=t.VA.Implementation.DataFlow.Functions[a].DataPanel),new r(e,i);}},e.prototype.createOutDataPanel=function(e,i){if(i.fnUnit[OUT_DATA]){i.title=i.title||"Out",i.resizable=!!i.fnUnit[IN_DATA];var a=i.fnUnit.func,r=t.VA.Implementation.DataFlow.Functions[a].DataPanel||t.VA.Core.Editors.Sheet.Panels.DataPanel;return"eDA"===a&&(r=t.VA.Implementation.DataFlow.Functions[a].DataPanel),new r(e,i);}},t.VA.Implementation.DataFlow.Editors.Sheet.PanelFactory=e;}.call(this),function(){"use strict";var t=this.Brightics;function e(e,i){this.colorSet=["#FD026C","#4682B8","#A5D22D","#F5CC0A","#FE8C01","#6B9494","#B97C46","#84ACD0","#C2E173","#F9DD5B","#FE569D","#FEB356","#9CB8B8","#D0A884","#2E6072","#6D8C1E","#A48806","#A90148","#A95E01","#476363","#7B532F"],t.VA.Core.Editors.Sheet.Panels.DataPanel.call(this,e,i),this._queryTable();}e.prototype=Object.create(t.VA.Core.Editors.Sheet.Panels.DataPanel.prototype),e.prototype.constructor=e,e.prototype.destroy=function(){this.pagination&&this.pagination.destroy(),this.dataWorksheet&&this.dataWorksheet.destroy(),t.VA.Core.Editors.Sheet.Panels.BasePanel.prototype.destroy.call(this),this.options.modelEditor.removeCommandListener(this.commandListener);},e.prototype._queryTable=function(){var t=this,e=this.display.tableList,i=function i(e){if(0===a.length){t.$contentsArea.empty();var i=$('<div class="brtc-va-editors-sheet-controls-dataworksheet brtc-style-interactive-prediction-out-panel"></div>');t.$contentsArea.append(i),i.empty();var r=$('<div class="brtc-va-interactive-prediction-message-wrapper brtc-style-interactive-prediction-message-wrapper">   <div class="brtc-va-interactive-prediction-message brtc-style-interactive-prediction-message">Please run the function for results.</div></div>');i.append(r);}else!1===t._isDisposed()&&(t.createDataWorksheet(a),t.$topArea.attr("has-data","true"));},a=[];9===e.length&&t.options.dataProxy.requestDataForEDA(e[0],function(r){a.push(r),t.options.dataProxy.requestDataForEDA(e[1],function(r){a.push(r),t.options.dataProxy.requestDataForEDA(e[2],function(r){a.push(r),t.options.dataProxy.requestDataForEDA(e[3],function(r){a.push(r),t.options.dataProxy.requestDataForEDA(e[4],function(r){a.push(r),t.options.dataProxy.requestDataForEDA(e[5],function(r){a.push(r),t.options.dataProxy.requestDataForEDA(e[6],function(r){a.push(r),t.options.dataProxy.requestDataForEDA(e[7],function(r){a.push(r),t.options.dataProxy.requestDataForEDA(e[8],function(e){a.push(e),!1===t._isDisposed()&&(t.createDataWorksheet(a),t.$topArea.attr("has-data","true"));},i);},i);},i);},i);},i);},i);},i);},i);},i);},e.prototype.createDataWorksheet=function(t){this.$contentsArea.empty();var e=void 0!==t,i=$('<div class="brtc-va-editors-sheet-controls-dataworksheet brtc-style-interactive-prediction-out-panel" style="overflow-y: auto">   <div class="brtc-va-editors-sheet-controls-dataworksheet-chart-area brtc-style-editors-sheet-controls-dataworksheet-chart-area">       <div class="brtc-va-editors-sheet-controls-dataworksheet-chart-scatter brtc-style-editors-sheet-controls-dataworksheet-chart-title">Scatter Matrix</div>       <div class="brtc-va-editors-sheet-controls-dataworksheet-chart-scatter brtc-style-editors-sheet-controls-dataworksheet-chart" style="height: 500px"/>       <div class="brtc-va-editors-sheet-controls-dataworksheet-chart-pie brtc-style-editors-sheet-controls-dataworksheet-chart-title">Summary of Label</div>       <div class="brtc-va-editors-sheet-controls-dataworksheet-chart-pie brtc-style-editors-sheet-controls-dataworksheet-chart" style="height: 400px"/>       <div class="brtc-va-editors-sheet-controls-dataworksheet-chart-pietable brtc-style-editors-sheet-controls-dataworksheet-chart" style="height: 100px"/>       <div class="brtc-va-editors-sheet-controls-dataworksheet-chart-histogram-title brtc-style-editors-sheet-controls-dataworksheet-chart-title">Summary of Continuous Features</div>       <div class="brtc-va-editors-sheet-controls-dataworksheet-chart-histogram brtc-style-editors-sheet-controls-dataworksheet-chart"/>       <div class="brtc-va-editors-sheet-controls-dataworksheet-chart-histogramtable brtc-style-editors-sheet-controls-dataworksheet-chart" style="height: 150px"/>   </div></div>');if(this.$contentsArea.append(i),e){if(i.find(".brtc-va-interactive-prediction-message-wrapper").remove(),this._createScatterChartControls(i.find(".brtc-va-editors-sheet-controls-dataworksheet-chart-scatter"),t),this._createPieChartControls(i.find(".brtc-va-editors-sheet-controls-dataworksheet-chart-pie"),t[3]),this._createTableChartControls(i.find(".brtc-va-editors-sheet-controls-dataworksheet-chart-pietable"),t[4]),this._createHistogramChartControls(i.find(".brtc-va-editors-sheet-controls-dataworksheet-chart-histogram"),t[5]),this._createTableChartControls(i.find(".brtc-va-editors-sheet-controls-dataworksheet-chart-histogram"),t[6]),void 0!==t[7]&&void 0!==t[8]&&0!==t[7].count&&0!==t[8].count){var a=$('<div class="brtc-va-editors-sheet-controls-dataworksheet-chart-pie2-title brtc-style-editors-sheet-controls-dataworksheet-chart-title">Summary of Category Features</div><div class="brtc-va-editors-sheet-controls-dataworksheet-chart-pie2 brtc-style-editors-sheet-controls-dataworksheet-chart"/><div class="brtc-va-editors-sheet-controls-dataworksheet-chart-pie2table brtc-style-editors-sheet-controls-dataworksheet-chart" style="height: 100px"/>');i.find(".brtc-va-editors-sheet-controls-dataworksheet-chart-histogram").append(a),this._createCategoryPieChartControls(i.find(".brtc-va-editors-sheet-controls-dataworksheet-chart-pie2"),t[7]),this._createTableChartControls(i.find(".brtc-va-editors-sheet-controls-dataworksheet-chart-pie2"),t[8]);}}else{i.empty();var r=$('<div class="brtc-va-interactive-prediction-message-wrapper brtc-style-interactive-prediction-message-wrapper">   <div class="brtc-va-interactive-prediction-message brtc-style-interactive-prediction-message">Please run the function for results.</div></div>');i.append(r);}},e.prototype._createScatterChartControls=function(t,e){var i=echarts.init(t[1]);this.resizeHandler=function(){i.resize();},$(window).resize(this.resizeHandler);var a=e[0].data,r=e[1].data,o=e[2].data;if(!(_.isEmpty(a)||_.isEmpty(r)||_.isEmpty(o))){var n=[];for(var s in r){if("category"===r[s][1]){for(var l in r[s][2]){null==r[s][2][l]&&(r[s][2][l]="(empty)");}null==r[s][a[0][4]]&&(o[s][a[0][4]]="(empty)"),n.push(r[s][2]);}}var c=[];for(var s in o){null==o[s][a[0][4]]&&(o[s][a[0][4]]="(empty)");var d={name:o[s][0],value:o[s][1]};c.push(d);}var p=a[0][1],h=2,u=5,m=10,f=(100-u-h)/p-h,v=(100-m-h)/p-h,b=a[0][4],g=3,y=[];for(s=0;s<r[a[0][4]][2].length;s++){y.push(this.colorSet[s%this.colorSet.length]);}var C={animation:!1,visualMap:{type:"piecewise",categories:r[a[0][4]][2],dimension:b,orient:"horizontal",top:0,left:"center",inRange:{color:y},outOfRange:{color:"#ddd"},seriesIndex:[0]},tooltip:{trigger:"item"},grid:[],xAxis:[],yAxis:[],series:[{name:"parallel",type:"parallel",data:o}]};!function(t){for(var e=0,i=0;i<p;i++){for(var a=0;a<p;a++){p-i+a>=p||(t.grid.push({left:u+i*(f+h)+"%",top:m+a*(v+h)+"%",width:f+"%",height:v+"%"}),t.xAxis.push({splitNumber:3,position:"top",axisLine:{show:0===a,onZero:!1},axisTick:{show:0===a,inside:!0},axisLabel:{show:0===a},type:"value",gridIndex:e,scale:!0}),t.yAxis.push({splitNumber:3,position:"right",axisLine:{show:i===p-1,onZero:!1},axisTick:{show:i===p-1,inside:!0},axisLabel:{show:i===p-1},type:"value",gridIndex:e,scale:!0}),t.series.push({type:"scatter",symbolSize:g,xAxisIndex:e,yAxisIndex:e,data:x(o,i,a)}),t.visualMap.seriesIndex.push(t.series.length-1),e++);}}}(C),i.setOption(C);}function x(t,e,i){for(var a=[],r=0;r<t.length;r++){var o=[t[r][e],t[r][i]];o[b]=t[r][b],a.push(o);}return a;}},e.prototype._createPieChartControls=function(t,e){var i=echarts.init(t[1]);this.resizeHandler=function(){i.resize();},$(window).resize(this.resizeHandler);var a=e.data,r=e.columns,o=[],n=[];for(var s in a){null==a[s][0]&&(a[s][0]="(empty)"),o.push(a[s][0]);var l={name:a[s][0],value:a[s][1]};n.push(l);}var c=r[0].name,d=[];for(s=0;s<n.length;s++){d.push(this.colorSet[s%this.colorSet.length]);}var p={color:d,tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"horizontal",left:"center",data:o},series:[{name:c,type:"pie",radius:"55%",center:["50%","45%"],data:n,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};i.setOption(p);},e.prototype._createCategoryPieChartControls=function(t,e){var i=e.data;this.PieChartData=[],this.colArray=[];for(var a=1;a<i.length;a++){-1==$.inArray(i[a][0],this.colArray)&&this.colArray.push(i[a][0]);}for(a=0;a<this.colArray.length;a++){this.PieChartData[this.colArray[a]]=[];for(var r=0;r<i.length;r++){if(i[r][0]===this.colArray[a]){var o=[];o.push(i[r][1]),o.push(i[r][2]),this.PieChartData[this.colArray[a]].push(o);}}}for(var a in this.PieChartData){var n=$('<div class="brtc-va-editors-sheet-controls-dataworksheet-chart-pie-sub brtc-style-editors-sheet-controls-dataworksheet-chart" style="height: 400px;"/>');t.append(n);var s=echarts.init(n[0]);this.resizeHandler=function(){s.resize();},$(window).resize(this.resizeHandler);var l=[],c=[];for(var r in this.PieChartData[a]){null==this.PieChartData[a][r][0]&&(this.PieChartData[a][r][0]="(empty)"),l.push(this.PieChartData[a][r][0]);var d={name:this.PieChartData[a][r][0],value:this.PieChartData[a][r][1]};c.push(d);}var p=a,h=[];for(a=0;a<c.length;a++){h.push(this.colorSet[a%this.colorSet.length]);}var u={color:h,tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"horizontal",left:"center",data:l},series:[{name:p,type:"pie",radius:"55%",center:["50%","45%"],data:c,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};s.setOption(u);}},e.prototype._createTableChartControls=function(t,e){var i=e.data,a=e.columns,r=[];for(var o in a){var n={name:a[o].name,type:a[o].type};r.push(n);}var s={chart:{type:"table",padding:"0",height:"100%"},source:{dataType:"local",localData:[{dataType:"rawdata",columns:r,data:i,chartColumns:[]}]}};t.bcharts(s),this.chart=t.bcharts();},e.prototype._createHistogramChartControls=function(t,e){var i=e.data;this.HistogramChartData=[],this.colArray=[];for(var a=0;a<i.length;a++){-1==$.inArray(i[a][0],this.colArray)&&this.colArray.push(i[a][0]);}for(a=0;a<this.colArray.length;a++){this.HistogramChartData[this.colArray[a]]=[];for(var r=0;r<i.length;r++){if(i[r][0]===this.colArray[a]){var o=[];o.push((i[r][1]+i[r][2])/2),o.push(i[r][3]),this.HistogramChartData[this.colArray[a]].push(o);}}}for(var a in this.HistogramChartData){var n=$('<div class="brtc-va-editors-sheet-controls-dataworksheet-chart-histogram-sub brtc-style-editors-sheet-controls-dataworksheet-chart" style="height: 250px;"/>');t.append(n);var s=echarts.init(n[0]);this.resizeHandler=function(){s.resize();},$(window).resize(this.resizeHandler);var l={title:{text:a,left:"center",top:10},color:["rgb(25, 183, 207)"],grid:{left:"3%",right:"3%",bottom:"3%",containLabel:!0},xAxis:[{type:"value",scale:!0,nameLocation:"center"}],yAxis:[{type:"value"}],series:[{name:"height",type:"bar",barWidth:"99.3%",label:{normal:{show:!0,position:"top",formatter:function formatter(t){return t.value[1];}}},data:this.HistogramChartData[a]}]};s.setOption(l);}},t.VA.Implementation.DataFlow.Functions.eDA&&(t.VA.Implementation.DataFlow.Functions.eDA.DataPanel=e);}.call(this),function(){"use strict";var t=this.Brightics;function e(e,i){this.relationFunctionTable=[],this.coefficientFunctionTable=[],this.summaryTable=[],this.summaryKey={},this.values={},this.ycolumnSummaryData=[],this.xcolumnsSummaryData=[],t.VA.Core.Editors.Sheet.Panels.DataPanel.call(this,e,i),this._queryTable();}e.prototype=Object.create(t.VA.Core.Editors.Sheet.Panels.DataPanel.prototype),e.prototype.constructor=e,e.prototype.registerCommandListener=function(){var e=this;this.commandListener=function(i){i instanceof t.VA.Core.Editors.Diagram.Commands.SetDataWorksheetPanelCommand&&e.options.fnUnit.fid===i.event.source.options.fnUnit.fid&&e.handleSetDataWorksheetPanelCommand(i);},this.options.modelEditor.addCommandListener(this.commandListener);},e.prototype.handleSetDataWorksheetPanelCommand=function(t){this._initSlideBarData(),this._setAllSliderControlsValue(),"UNDO"==t.event.type?this._updateChartControls(t.options.oldPanel[0].data[0].label,t.options.oldPanel[0].data[0].value):"REDO"==t.event.type&&this._updateChartControls(t.options.newPanel[0].data[0].label,t.options.newPanel[0].data[0].value);},e.prototype.createSetDataWorksheetPanelCommand=function(e){return new t.VA.Core.Editors.Diagram.Commands.SetDataWorksheetPanelCommand(this,{panel:this.options.fnUnit.display.sheet[this.display.panelType].partial[0].panel,newPanel:e});},e.prototype.destroy=function(){this.pagination&&this.pagination.destroy(),this.dataWorksheet&&this.dataWorksheet.destroy(),t.VA.Core.Editors.Sheet.Panels.BasePanel.prototype.destroy.call(this),this.options.modelEditor.removeCommandListener(this.commandListener);},e.prototype.createTopAreaHeaderTitle=function(t){this.$header=$('<div class="brtc-va-editors-sheet-panels-basepanel-header brtc-va-editors-sheet-panels-datapanel-header">   <div class="brtc-va-editors-sheet-panels-basepanel-header-container brtc-interactive-prediction-out-panel">       <div class="brtc-va-editors-sheet-panels-basepanel-header-title" />   </div></div>'),t.append(this.$header);},e.prototype.refreshHeaderTitle=function(){var t=this.$mainControl.find(".brtc-va-editors-sheet-panels-basepanel-header-title");"out"===this.display.panelType&&(t.text(this.options.title),t.attr("title",this.options.title));},e.prototype.createTopAreaHeaderToolbar=function(){var t=$('<div class="brtc-va-editors-sheet-panels-datapanel-toolbar"/>');this.$header.append(t),this.createMinMaxToolItem(t);},e.prototype.createBottomArea=function(){this.$bottomArea=$('<div class="brtc-va-editors-sheet-panels-basepanel-bottom-area"></div>'),this.$mainControl.append(this.$bottomArea);},e.prototype.createBottomAreaControls=function(t){},e.prototype._queryTable=function(){var t=this,e=this.display.tableList,i=function i(e){t.$contentsArea.empty();var i=$('<div class="brtc-va-editors-sheet-controls-dataworksheet brtc-style-interactive-prediction-out-panel"></div>');t.$contentsArea.append(i),i.empty();var a=$('<div class="brtc-va-interactive-prediction-message-wrapper brtc-style-interactive-prediction-message-wrapper">   <div class="brtc-va-interactive-prediction-message brtc-style-interactive-prediction-message">Please run the function for results.</div></div>');i.append(a);},a=[];3===e.length&&t.options.dataProxy.requestData(e[0],function(r){a.push(r),t.options.dataProxy.requestData(e[1],function(r){a.push(r),t.options.dataProxy.requestData(e[2],function(e){a.push(e),!1===t._isDisposed()&&(t.createDataWorksheet(a),t.$topArea.attr("has-data","true"));},i);},i);},i);},e.prototype.createDataWorksheet=function(t){this.$contentsArea.empty();var e=void 0!==t;for(var i in t){if(0===t[i].data.length&&0===t[i].columns.length){e=!1;break;}}var a=$('<div class="brtc-va-editors-sheet-controls-dataworksheet brtc-style-interactive-prediction-out-panel">   <div class="brtc-va-editors-sheet-controls-dataworksheet-slider-area brtc-style-editors-sheet-controls-dataworksheet-slider-area"></div>   <div class="brtc-va-editors-sheet-controls-dataworksheet-chart-area brtc-style-editors-sheet-controls-dataworksheet-chart-area">       <div class="brtc-va-editors-sheet-controls-dataworksheet-chart brtc-style-editors-sheet-controls-dataworksheet-chart">   </div></div>');if(this.$contentsArea.append(a),e)a.find(".brtc-va-interactive-prediction-message-wrapper").remove(),this._initDataArray(t),this._initChartData(),this._initSlideBarData(),this._createSliderControls(a.find(".brtc-va-editors-sheet-controls-dataworksheet-slider-area")),this._createChartControls(a.find(".brtc-va-editors-sheet-controls-dataworksheet-chart"));else{a.empty();var r=$('<div class="brtc-va-interactive-prediction-message-wrapper brtc-style-interactive-prediction-message-wrapper">   <div class="brtc-va-interactive-prediction-message brtc-style-interactive-prediction-message">Please run the function for results.</div></div>');a.append(r);}},e.prototype._initDataArray=function(t){if(t&&t.length){for(var e in this.relationFunctionTable=t[0],this.coefficientFunctionTable=t[1],this.summaryTable=t[2],this.summaryKey={},this.summaryTable.columns){this.summaryKey[this.summaryTable.columns[e].name]=e;}this.values={},this.ycolumnSummaryData=[],this.xcolumnsSummaryData=[],this._initValuesObject();}},e.prototype._initValuesObject=function(){var t=this.summaryTable.data[0][0];for(var e in this.summaryTable.data){var i=this.summaryTable.data[e][0];i==t?this.ycolumnSummaryData=this.summaryTable.data[e]:this.xcolumnsSummaryData.push(this.summaryTable.data[e]),this.values[i]=null;}},e.prototype._initChartData=function(){for(i in this.chartData={},this.xcolumnsSummaryData){var t=this.xcolumnsSummaryData[i][0],e=this.xcolumnsSummaryData[i][this.summaryKey.min],a=this.xcolumnsSummaryData[i][this.summaryKey.max];this.chartData[t]=[];for(var r=1e4*e;r<1e4*a;r+=100){var o=r/1e4;this._changeXColumnValue(t,o),this._calcYColumnValue(),this.chartData[t].push([o,this.values[this.summaryTable.data[0][0]]]);}}},e.prototype._getLastChangedXColumnLabel=function(){var t;return this.options.fnUnit.display.sheet.out.partial[0].panel.length&&this.options.fnUnit.display.sheet.out.partial[0].panel[0]&&(t=this.options.fnUnit.display.sheet.out.partial[0].panel[0].data[0].label),t||this.xcolumnsSummaryData[0][0];},e.prototype._getLastChangedXColumnValue=function(){var t;return this.options.fnUnit.display.sheet.out.partial[0].panel.length&&this.options.fnUnit.display.sheet.out.partial[0].panel[0]&&(t=this.options.fnUnit.display.sheet.out.partial[0].panel[0].data[0].value),t||this.xcolumnsSummaryData[0][this.summaryKey.mean];},e.prototype._initSlideBarData=function(){var t=this._getLastChangedXColumnLabel(),e=this._getLastChangedXColumnValue();this._changeXColumnValue(t,e),this._calcYColumnValue();},e.prototype._changeXColumnValue=function(t,e){e&&(this.values[t]=Number(e));var i=this.values[t];for(var a in this.relationFunctionTable.data){var r=this.relationFunctionTable.data[a],o=r[0],n=r[1];if(o!==n&&n===t){var s=Number(r[2]),l=Number(r[3]),c=Number(r[4]),d=Number(r[5]);this.values[o]=s*Math.pow(i,3)+l*Math.pow(i,2)+c*i+d;}}},e.prototype._calcYColumnValue=function(){var t,e=this.summaryTable.data[0][0];for(var i in this.coefficientFunctionTable.data){if("_intercept"==this.coefficientFunctionTable.data[i][0]&&"_"==this.coefficientFunctionTable.data[i][1]){t=this.coefficientFunctionTable.data[i][2];break;}}this.values[e]=Number(t);for(var a=0;a<this.coefficientFunctionTable.data.length;a++){var r=this.coefficientFunctionTable.data[a][0],o=this.coefficientFunctionTable.data[a][1];if("_intercept"!==r&&"_"!==o){var n=this.values[r]||1,s=this.values[o]||1,l=Number(this.coefficientFunctionTable.data[a][2]);this.values[e]+=l*n*s;}}},e.prototype._createSliderControls=function(t){var e=this.summaryTable.data[0][0],i=this.ycolumnSummaryData[this.summaryKey.min],a=this.ycolumnSummaryData[this.summaryKey.max];for(var r in this._createSliderBar(t,e,i,a,this.values[e],!0),this.xcolumnsSummaryData){var o=this.xcolumnsSummaryData[r][0],n=this.xcolumnsSummaryData[r][this.summaryKey.min],s=this.xcolumnsSummaryData[r][this.summaryKey.max];this._createSliderBar(t,o,n,s,this.values[o]);}},e.prototype._createSliderBar=function(e,i,a,r,o,n){var s=this,l=$('<div class="brtc-va-slider-item brtc-style-slider-item">   <div class="brtc-va-slider-item-info-row brtc-style-slider-item-info-row">       <div class="brtc-va-slider-label brtc-style-slider-label"></div>       <div class="brtc-va-slider-value-wrapper brtc-style-slider-value-wrapper">           <div class="brtc-va-slider-value-viewer brtc-style-slider-value-viewer"></div>       </div>   </div>   <div class="brtc-va-interactive-prediction-slider-element brtc-style-interactive-prediction-slider-element">       <div class="brtc-va-slider-min brtc-style-slider-min"></div>       <div class="brtc-va-interactive-prediction-slider-wrapper brtc-style-interactive-prediction-slider-wrapper">           <div class="brtc-va-interactive-prediction-slider"></div>       </div>       <div class="brtc-va-slider-max brtc-style-slider-max"></div>   </div></div>');e.append(l),l.find(".brtc-va-slider-label").attr("title",i),l.find(".brtc-va-slider-label").text(i),l.find(".brtc-va-slider-min").text(a),l.find(".brtc-va-slider-max").text(r),l.find(".brtc-va-slider-value-viewer").text(Number(o).toFixed(4));var c=l.find(".brtc-va-interactive-prediction-slider");c.jqxSlider({theme:t.VA.Env.Theme,showTicks:!1,showTickLabels:!1,tooltip:!1,showButtons:!1,mode:"default",height:20,width:"100%",step:.05,min:Number(a),max:Number(r),value:Number(o),disabled:n}),c.on("slideStart",function(t){c.on("slide",function(t){var e=l.find(".brtc-va-slider-label").text(),i=t.args.value;s._changeXColumnValue(e,i),s._calcYColumnValue(),s._setSliderControlsValue(l),s._updateChartControls(e,i);});}),c.on("slideEnd",function(t){var e=l.find(".brtc-va-slider-label").text(),i=t.args.value;c.off("slide");var a=s.createSetDataWorksheetPanelCommand([{data:[{label:e,value:i}]}]);s.executeCommand(a);});},e.prototype._setSliderControlsValue=function(t){var e=this;this.$contentsArea.find(".brtc-va-slider-item").each(function(i,a){var r=$(a).find(".brtc-va-slider-label").text();($(a).find(".brtc-va-slider-value-viewer").text(Number(e.values[r]).toFixed(4)),t&&!t.is($(a)))&&$(a).find(".brtc-va-interactive-prediction-slider").jqxSlider("setValue",e.values[r]);});},e.prototype._setAllSliderControlsValue=function(){var t=this;this.$contentsArea.find(".brtc-va-slider-item").each(function(e,i){var a=$(i).find(".brtc-va-slider-label").text();$(i).find(".brtc-va-slider-value-viewer").text(Number(t.values[a]).toFixed(4)),$(i).find(".brtc-va-interactive-prediction-slider").jqxSlider("setValue",t.values[a]);});},e.prototype._createChartControls=function(t){var e=this._createChartOptions(this._getLastChangedXColumnLabel(),this._getLastChangedXColumnValue(),!0);t.bcharts(e),this.chart=t.bcharts();},e.prototype._updateChartControls=function(t,e){var i=this._createChartOptions(t,e,this.chart.getOptions().xAxis[0].selected[0].name!==t);this.chart.setOptions(i);},e.prototype._createChartOptions=function(t,e,i){var a=t,r=e,o=this.summaryTable.data[0][0],n={colorSet:["#FD026C","#4682B8","#A5D22D","#F5CC0A","#FE8C01","#6B9494","#B97C46","#84ACD0","#C2E173","#F9DD5B","#FE569D","#FEB356","#9CB8B8","#D0A884","#2E6072","#6D8C1E","#A48806","#A90148","#A95E01","#476363","#7B532F"],tooltip:{trigger:"axis",axisPointer:{animation:!1}},xAxis:[{selected:[{name:a}],title:{visible:!0,left:"50%",bottom:"8px"},axisTick:{alignWithLabel:!0},axisLabel:{formatter:function formatter(t){return Number(t).toFixed(2);}}}],yAxis:[{selected:[{name:o}],title:{left:"8px",top:"50%",rotate:-90},axisLabel:{formatter:function formatter(t){return Number(t).toFixed(2);}}}],plotOptions:{line:{smooth:!0,marker:{symbol:"none"},markLine:{data:[{xAxis:r,lineStyle:{normal:{color:"#000",type:"solid"}}},{type:"max",name:"max"},{type:"average",name:"average"},{type:"min",name:"min"}]}}}};return i&&(n.chart={type:"line",border:"solid 1px #d3d3d3",padding:"0",background:"#efefef",height:"100%"},n.source={dataType:"local",localData:[{dataType:"rawdata",columns:[{name:a,type:"number"},{name:o,type:"number"}],data:$.extend(!0,[],this.chartData[a])}]}),n;},t.VA.Implementation.DataFlow.Functions.interactivePrediction&&(t.VA.Implementation.DataFlow.Functions.interactivePrediction.DataPanel=e);}.call(this),function(){"use strict";var t=this.Brightics;function e(e,i){i.title="Browse Repository",t.VA.Core.Editors.Sheet.Panels.BasePanel.call(this,e,i),this.$mainControl.addClass("repository-viewer");}e.prototype=Object.create(t.VA.Core.Editors.Sheet.Panels.BasePanel.prototype),e.prototype.constructor=e,e.prototype.createContentsAreaControls=function(t){this.options.filePath=this.options.filePath||"",t.empty(),this.createDialogContentsArea(t);},e.prototype.createDialogContentsArea=function(t){t.addClass("brtc-va-dialogs-repository-browser-contents"),t.append('<div class="brtc-va-dialogs-repository-browser-tree"></div><div class="brtc-va-dialogs-repository-browser-file-layout">   <div class="brtc-va-dialogs-repository-browser-file-label">File Path</div>   <div class="brtc-va-dialogs-repository-browser-file-input"><textarea></textarea></div></div><div class="brtc-va-dialogs-repository-browser-setting-option">   <div class="brtc-va-dialogs-repository-browser-radio" value="static">Set a static file path for users repository.</div>   <div class="brtc-va-dialogs-repository-browser-radio" value="dynamic">Set a dynamic file path for users repository.</div></div>'),this.createRepositoryTree(t.find(".brtc-va-dialogs-repository-browser-tree")),this.createSettingOptionControl(t.find(".brtc-va-dialogs-repository-browser-setting-option")),this.createFilePathControl(t.find(".brtc-va-dialogs-repository-browser-file-input > textarea"));},e.prototype.createRepositoryTree=function(e){var i=this;this.repositoryViewer=new t.VA.Core.Controls.RepositoryViewer(e),this.repositoryViewer.$tree.on("select",function(t){var e=i.repositoryViewer.getSelectedPath();i._setFilePath(e);});},e.prototype.createSettingOptionControl=function(e){var i=this,a=e.find(".brtc-va-dialogs-repository-browser-radio");this.$settingOptionGroup=e,a.jqxRadioButton({theme:t.VA.Env.Theme,groupName:"repository-browser-setting-option"}),a.on("checked",function(){var t=i.repositoryViewer.getSelectedPath()||i.options.filePath;i._setFilePath(t);}),this.options.filePath.match(/\/users\/\$\{sys.user\}\//g)?this.$settingOptionGroup.find(".brtc-va-dialogs-repository-browser-radio[value=dynamic]").jqxRadioButton("check"):this.$settingOptionGroup.find(".brtc-va-dialogs-repository-browser-radio[value=static]").jqxRadioButton("check"),this.$settingOptionGroup.find(".brtc-va-dialogs-repository-browser-radio").hide();},e.prototype.createFilePathControl=function(e){this.fileName=CodeMirror.fromTextArea(e[0],{mode:"text",theme:"default",indentWithTabs:!1,smartIndent:!1,lineNumbers:!1,matchBrackets:!0,scrollbarStyle:"null",autofocus:!1,readOnly:!0}),this.fileName.on("beforeChange",function(t,e){var i=e.text.join("").replace(/\n/g,"");return e.update&&e.update(e.from,e.to,[i]),!0;}),this.fileName.setSize("100%","100%"),this.options.filePath&&this._setFilePath(this.options.filePath);t.VA.Core.Utils.WidgetUtils.changeCodeMirrorLineToSingle(this.fileName,{"valid-type":"fileNameType","valid-message-position":"bottom"});},e.prototype._setFilePath=function(e){if(e){var i=e.match(/^\/brtc\/repo\/shared\/[^\/]*/),a=e.match(/^\/brtc\/repo\/users\/[^\/]+\/[^\/]*/);if(this.$settingOptionGroup.find(".brtc-va-dialogs-repository-browser-radio").hide(),i)this.fileName.setValue(e),this.fileName.markText({line:0,ch:0},{line:0,ch:18},{readOnly:!0,inclusiveLeft:!0,css:"color: #b4b4b4"});else if(a){this.$settingOptionGroup.find(".brtc-va-dialogs-repository-browser-radio").show();var r=0,o=e,n=(o=this.$settingOptionGroup.find(".brtc-va-dialogs-repository-browser-radio[value=dynamic]").val()?o.replace(/\/users\/\S*\//g,"/users/${sys.user}/"):o.replace(/\/users\/\$\{sys\.user\}\//g,"/users/"+t.VA.Env.Session.userId+"/")).split("/");this.fileName.setValue(o);for(var s=0;s<5;s++){r+=n[s].length,r++;}this.fileName.markText({line:0,ch:0},{line:0,ch:r},{readOnly:!0,inclusiveLeft:!0,css:"color: #b4b4b4"});}else o=e+"/",o=this.$settingOptionGroup.find(".brtc-va-dialogs-repository-browser-radio[value=dynamic]").val()?o.replace(/\/users\/\S*\//g,"/users/${sys.user}/"):o.replace(/\/users\/\$\{sys\.user\}\//g,"/users/"+t.VA.Env.Session.userId+"/"),this.fileName.setValue(o),this.fileName.markText({line:0,ch:0},{line:0,ch:o.length+1},{readOnly:!0,inclusiveLeft:!0,css:"color: #b4b4b4"});}},t.VA.Implementation.DataFlow.Functions.import&&(t.VA.Implementation.DataFlow.Functions.import.DataPanel=e),t.VA.Implementation.DataFlow.Functions.export&&(t.VA.Implementation.DataFlow.Functions.export.DataPanel=e);}.call(this),function(){"use strict";var t=this.Brightics;function e(e,i){this._propertiesPanelParams=this._getParams(),t.VA.Core.Editors.Sheet.Panels.PropertiesPanel.call(this,e,i);}e.prototype=Object.create(t.VA.Core.Editors.Sheet.Panels.PropertiesPanel.prototype),e.prototype.constructor=e,e.prototype.createControls=function(){t.VA.Core.Editors.Sheet.Panels.PropertiesPanel.prototype.createControls.call(this),this.retrieveTableInfo(this.FnUnitUtils.getInTable(this.options.fnUnit));},e.prototype.createContentsAreaControls=function(e){t.VA.Core.Editors.Sheet.Panels.PropertiesPanel.prototype.createContentsAreaControls.call(this,e),this.$elements={},this.controls={},this.visibleOptionMap={},this._controlCreator=new t.VA.Implementation.DataFlow.UdfInvokeControlCreator(this),this._renderCreateor=new t.VA.Implementation.DataFlow.UdfInvokeControlRenderer(this),this._columnSelectorList=[],this.createControlsBySpec(this._propertiesPanelParams),this.render=this._createRenderer();},e.prototype._createRenderer=function(){var t=this.createRendererBySpec(this._propertiesPanelParams);return Object.keys(this.visibleOptionMap).length>0&&(t.$$VisibleOptionRenderer$$=this._renderVisibleOption.bind(this)),t;},e.prototype.createControlsBySpec=function(t){var e;for(var i in t){e=t[i],this._controlCreator.createInvokeControl(e),this._initVisibleOption(e);}},e.prototype.createRendererBySpec=function(t){var e,i={};for(var a in t){i[(e=t[a]).id]=this._renderCreateor.createInvokeRenderer(e);}return i;},e.prototype.fillControlValues=function(){for(var t=this,e=0;e<this._columnSelectorList.length;e++){var i=this._columnSelectorList[e].spec;!function(e){var a=t._getTargetColumns(i);t._columnSelectorList[e].control.setItems(a);}(e);}},e.prototype._getTargetColumns=function(t){var e,i=[],a=t.targetTable,r=t.columnType;if(void 0===(e=a&&a.length>0?this.FnUnitUtils.getInTableByKeys(this.options.fnUnit,a):this.FnUnitUtils.getInTable(this.options.fnUnit)))return i;for(var o=0;o<e.length;o++){i=i.concat(this.dataMap&&e[o]?this.dataMap[e[o]].columns:[]);}return r&&r.length>0?i=i.filter(function(t){return r.indexOf(t.internalType)>=0;}):r&&0===r.length&&(i=i.filter(function(t){return"Image"!==t.internalType;})),i;},e.prototype.renderValidation=function(){for(var t in this.problems){this.problems[t].param&&this.createValidationContent(this.$elements[this.problems[t].param],this.problems[t]);}},e.prototype._initVisibleOption=function(t){t.visibleOption&&t.visibleOption.length>0&&(this.visibleOptionMap[t.id]=t.visibleOption);},e.prototype._getPropertyControlById=function(t){return this.$elements[t].closest(".brtc-va-editors-sheet-controls-propertycontrol");},e.prototype.createColumnsCommand=function(e,i){var a={fnUnit:this.options.fnUnit,ref:{param:{}}};return a.ref.param[e]=[i],new t.VA.Core.Editors.Diagram.Commands.SetFnUnitParameterValueCommand(this,a);},e.prototype._renderVisibleOption=function(){var t,e;for(var i in this.visibleOptionMap){t=this.visibleOptionMap[i],e=this._getPropertyControlById(i),this._checkVisibleOption(t)?e.show():e.hide();}},e.prototype._checkVisibleOption=function(t){for(var e,i,a=0;a<t.length;a++){if(e=t[a],i=e.value,_.isArray(this.options.fnUnit.param[e.id])&&this.options.fnUnit.param[e.id].every(function(t){return t!==i;}))return!1;if(!_.isArray(this.options.fnUnit.param[e.id])&&this.options.fnUnit.param[e.id]!==i)return!1;}return!0;},e.prototype.executeCommand=function(e){t.VA.Core.Editors.Sheet.Panels.PropertiesPanel.prototype.executeCommand.call(this,e),this._renderVisibleOption();},e.prototype.handleSetFnUnitParameterValueCommand=function(e){t.VA.Core.Editors.Sheet.Panels.PropertiesPanel.prototype.handleSetFnUnitParameterValueCommand.call(this,e),this.options.fnUnit.fid!=e.options.fnUnit.fid||"UNDO"!==e.event.type&&"REDO"!==e.event.type||this._renderVisibleOption();},t.VA.Implementation.DataFlow.Functions.BaseInvokeProperties=e;}.call(this),function(){"use strict";var t=this.Brightics,e=["Double","Integer","Long"];function i(t){this._super=t;}i.prototype.createInvokeControl=function(t){"ColumnSelector"===t.control?this.createColumnSelectorControl(t):"InputBox"===t.control?this.createInputBoxControl(t):"DropDownList"===t.control?this.createDropDownListControl(t):"RadioButton"===t.control?this.createRadioButtonControl(t):"BooleanRadio"===t.control?this.createBooleanRadioButtonControl(t):"CheckBox"===t.control?this.createCheckBoxControl(t):"ArrayInput"===t.control?this.createArrayInputControl(t):"Expression"===t.control?this.createExpressionControl(t):"FileSelector"===t.control&&this.createLocalFileSelector(t);},i.prototype.createLocalFileSelector=function(e){var i=this,a=e.id;this._super.$elements[a]=$('<div class="brtc-va-editors-sheet-controls-propertycontrol-contents"/>');var r=this._super.addPropertyControl(e.label,function(r){var o=$('<input type="text" class="brtc-va-editors-sheet-controls-propertycontrol-input-readonly"/>');i._super.createInput(o,{placeHolder:t.VA.Core.Utils.WidgetUtils.convertInequalitySign(e.placeHolder)},"brtc-va-editors-sheet-controls-margin-bottom"),o.prop("readonly",!0),r.append(o.parent()),o.click(function(){new t.VA.Core.Dialogs.RepositoryBrowserDialog(i._super.$mainControl,{pathLabel:e.label,filePath:o.val(),close:function close(e){e.OK&&e.selectedFile&&function(e,i){var a=o.val(),r=e[0]||"";if(a!==r){var n=function(e){var a={fnUnit:this._super.options.fnUnit,ref:{param:{}}};return a.ref.param[i]=[e],new t.VA.Core.Editors.Diagram.Commands.SetFnUnitCommand(this,a);}.bind(this)(r);this._super.executeCommand(n);}o.val(r),o.attr("title",r);}.bind(i)([e.selectedFile],a);},resizable:!1,title:"Setting "+e.label});}),i._super.controls[a]=o,i._super.$elements[a].on("change",function(t){if(i._super.isInputValueChanged(a,$(this).val())){var e=i._super.createSetParameterValueCommand(a,$(this).val());i._super.executeCommand(e);}});},{mandatory:!!e.mandatory}).find(".brtc-va-editors-sheet-controls-propertycontrol-label");this._super.addGlobalVariableControl(r,{},e.id,e.label,{type:"array"});},i.prototype.createColumnSelectorControl=function(t){var e=this,i=t.id;this._super.$elements[i]=$('<div class="brtc-va-editors-sheet-controls-propertycontrol-columnlist"/>'),this._super.addPropertyControl(t.label,function(a){a.append(e._super.$elements[i]);var r={multiple:t.multiple,maxRowCount:t.rowCount};t.multiple?r.changed=function(t,a){var r=e._super.createSetParameterValueCommand(i,a.items);e._super.executeCommand(r);}:r.changed=function(t,a){var r=e._super.createSetParameterValueCommand(i,a.items[0]||"");e._super.executeCommand(r);},e._super.controls[i]=e._super.createColumnList(e._super.$elements[i],r);var o={control:e._super.controls[i],spec:t};t.columnType&&(o.columnType=t.columnType),e._super._columnSelectorList.push(o);},{mandatory:t.mandatory});},i.prototype.createArrayInputControl=function(t){var i=this,a=t.id;this._super.$elements[a]=$('<div class="brtc-va-editors-sheet-controls-propertycontrol-numberinput"/>'),this._super.addPropertyControl(t.label,function(r){r.append(i._super.$elements[a]);var o={};e.indexOf(t.type)>=0?o.type="number":o.type="string",o.onChangeCallback=function(t){var e=i._super.createSetParameterValueCommand(a,t);i._super.executeCommand(e);},i._super.controls[a]=i._super.createArrayInput(i._super.$elements[a],o);},{mandatory:t.mandatory});},i.prototype.createInputBoxControl=function(t){e.indexOf(t.type)>=0?this.createNumericInputBoxControl(t):this.createStringInputBoxControl(t);},i.prototype.createNumericInputBoxControl=function(e){var i=this,a=e.id;this._super.$elements[a]=$('<div class="brtc-va-editors-sheet-controls-propertycontrol-numberinput"/>'),this._super.addPropertyControl(e.label,function(r){r.append(i._super.$elements[a]);var o={placeholder:t.VA.Core.Utils.WidgetUtils.convertInequalitySign(e.placeHolder)||""};void 0!==e.min&&(o.min=e.min),void 0!==e.max&&(o.max=e.max),"Integer"===e.type?o.numberType="int":o.numberType="double",i._super.controls[a]=i._super.createNumericInput(i._super.$elements[a],o),i._super.controls[a].onChange(function(){var t=i._super.controls[a].getValue();t=""===t?"":Number(t);var e=i._super.createSetParameterValueCommand(a,t);i._super.executeCommand(e);});},{mandatory:e.mandatory});},i.prototype.createStringInputBoxControl=function(e){var i=this,a=e.id;this._super.$elements[a]=$('<input type="text" class="brtc-va-editors-sheet-controls-propertycontrol-input"/>'),this._super.addPropertyControl(e.label,function(r){r.append(i._super.$elements[a]);var o={placeHolder:t.VA.Core.Utils.WidgetUtils.convertInequalitySign(e.placeHolder)||""};i._super.controls[a]=i._super.createInput(i._super.$elements[a],o),i._super.$elements[a].on("change",function(t){if(i._super.isInputValueChanged(a,$(this).val())){var e=i._super.createSetParameterValueCommand(a,$(this).val());i._super.executeCommand(e);}});},{mandatory:e.mandatory});},i.prototype.createDropDownListControl=function(t){var e=this,i=t.id;this._super.$elements[i]=$('<div class="brtc-va-editors-sheet-controls-propertycontrol-combobox"/>'),this._super.addPropertyControl(t.label,function(a){a.append(e._super.$elements[i]);var r={source:t.items};e._super.controls[i]=e._super.createDropDownList(e._super.$elements[i],r),e._super.controls[i].on("change",function(t){if(null!==t.args.item){var a=e._super.createSetParameterValueCommand(i,t.args.item.value);e._super.executeCommand(a);}});},{mandatory:t.mandatory});},i.prototype.createBooleanRadioButtonControl=function(t){var e=this,i=t.items,a=t.id;0===i.length&&(i.push({value:!0,label:"True",default:t.defaultValue}),i.push({value:!1,label:"False",default:!t.defaultValue})),this._super.controls[a]={};var r=this._super.controls[a];this._super.addPropertyControl(t.label,function(t){for(var o in e._super.$elements[a]=t,i){var n=$('<div class="brtc-va-editors-sheet-controls-propertycontrol-radiobutton" value="'+i[o].value+'">'+i[o].label+"</div>");t.append(n),r[i[o].value]=e._super.createRadioButton(n,{width:"undefined",groupName:a,checked:i[o].default}),r[i[o].value].on("checked",function(t){var i=!0===this.getAttribute("value")||"true"===this.getAttribute("value"),r=e._super.createSetParameterValueCommand(a,i);e._super.executeCommand(r);});}},{mandatory:t.mandatory});},i.prototype.createRadioButtonControl=function(t){var e=this,i=t.items,a=t.id;this._super.controls[a]={};var r=this._super.controls[a];this._super.addPropertyControl(t.label,function(t){for(var o in e._super.$elements[a]=t,i){var n=$('<div class="brtc-va-editors-sheet-controls-propertycontrol-radiobutton" value="'+i[o].value+'">'+i[o].label+"</div>");t.append(n),r[i[o].value]=e._super.createRadioButton(n,{width:"undefined",groupName:a,checked:i[o].default}),r[i[o].value].on("checked",function(t){var i=e._super.createSetParameterValueCommand(a,this.getAttribute("value"));e._super.executeCommand(i);});}},{mandatory:t.mandatory});},i.prototype.createCheckBoxControl=function(t){var e=this,i=t.items,a=t.id;this._super.controls[a]={};var r=this._super.controls[a],o=$('<div class="brtc-va-editors-sheet-controls-propertycontrol-checkbox-container"></div>'),n=$('<input type="button" value="Select All" style="width: 100%; float:left; margin-left: 0px;"/>'),s=$('<input type="button" value="Unselect All" style="width: 100%; float:left; margin-left: 2px; margin-bottom: 2px;"/>');for(var l in o.append(n),o.append(s),this._super.$elements[a]=o,i){r[i[l].value]=$('<div class="brtc-va-editors-sheet-controls-propertycontrol-radiobutton" value="'+i[l].value+'">'+i[l].label+"</div>");}this._super.addPropertyControl(t.label,function(i){i.append(o),e._super.createButton(n,{height:23},"brtc-va-editors-sheet-controls-width-6"),e._super.createButton(s,{height:23},"brtc-va-editors-sheet-controls-width-6");var l,c=t.items,d=function d(){$(window).trigger("mousedown");var t=[];for(var i in c){l=c[i].value,!0===r[l].val()&&t.push(r[l].data("tag"));}var o=e._super.createSetParameterValueCommand(a,t);e._super.executeCommand(o);};for(var p in c){l=c[p].value;var h=$('<div class="brtc-va-editors-sheet-controls-propertycontrol-checkbox"></div>');h.text(c[p].label),h.data("tag",c[p].value),o.append(h),r[l]=e._super.createCheckBox(h,{},"brtc-va-editors-sheet-controls-width-12"),r[l].on("change",d);}n.on("click",function(t){for(var i in c){l=c[i].value,r[l].off("change",d),r[l].jqxCheckBox({checked:!0}),r[l].on("change",d);}var o=[];for(var i in c){l=c[i].value,o.push(r[l].data("tag"));}var n=e._super.createSetParameterValueCommand(a,o);e._super.executeCommand(n);}),s.on("click",function(t){for(var i in c){l=c[i].value,r[l].off("change",d),r[l].jqxCheckBox({checked:!1}),r[l].on("change",d);}var o=e._super.createSetParameterValueCommand(a,[]);e._super.executeCommand(o);});},{mandatory:t.mandatory});},i.prototype.createExpressionControl=function(e){var i=this,a=e.id;this._super.$elements[a]=$('<div class="brtc-va-editors-sheet-controls-propertycontrol-expression"/>'),this._super.addPropertyControl(e.label,function(e){e.append(i._super.$elements[a]);i._super.controls[a]=t.VA.Core.Widget.Factory.aceEditorControl(i._super.$elements[a],{mode:"scala",commands:[],events:[],value:"",editorOptions:{showLineNumbers:!1,showGutter:!1}});var r=i._super.controls[a].getEditor();r.on("blur",function(t){if(i._super.isInputValueChanged(a,r.getValue())){var e=i._super.createSetParameterValueCommand(a,r.getValue());i._super.executeCommand(e);}});},{mandatory:e.mandatory});},t.VA.Implementation.DataFlow.UdfInvokeControlCreator=i;}.call(this),function(){"use strict";var t=this.Brightics;function e(t){this._super=t;}e.prototype.createInvokeRenderer=function(t){return"ColumnSelector"===t.control?this.createColumnSelectorRenderer(t):"InputBox"===t.control?this.createInputBoxRenderer(t):"DropDownList"===t.control?this.createDropDownListRenderer(t):"RadioButton"===t.control||"BooleanRadio"===t.control?this.createRadioButtonRenderer(t):"CheckBox"===t.control?this.createCheckBoxRenderer(t):"ArrayInput"===t.control?this.createArrayInputRenderer(t):"Expression"===t.control?this.createExpressionRenderer(t):"FileSelector"===t.control?this.createLocalFileSelectorRenderer(t):void 0;},e.prototype._getValueByParamId=function(t){return this._super.options.fnUnit.param[t];},e.prototype._getControlByParamId=function(t){return this._super.controls[t];},e.prototype.createColumnSelectorRenderer=function(t){var e=this,i=t.id;if(t.multiple)var a=function a(){var t=e._getValueByParamId(i)||[];e._getControlByParamId(i).setSelectedItems(t);};else a=function a(){var t=e._getValueByParamId(i)||"";e._getControlByParamId(i).setSelectedItems([t]);};return a;},e.prototype.createArrayInputRenderer=function(t){var e=this,i=t.id;return function(){var t=e._getValueByParamId(i)||[];e._getControlByParamId(i).setValue(t);};},e.prototype.createInputBoxRenderer=function(t){var e=this,i=t.id;return function(){var t=e._getValueByParamId(i),a=e._getControlByParamId(i);"function"==typeof a.val?a.val(t||""):a.setValue(t||"");};},e.prototype.createLocalFileSelectorRenderer=function(t){var e=this,i=t.id;return function(){var t=e._getValueByParamId(i),a=e._getControlByParamId(i),r=Array.isArray(t)?t[0]:t;"function"==typeof a.val?a.val(r||""):a.setValue(r||"");};},e.prototype.createDropDownListRenderer=function(t){var e=this,i=t.id;return function(){var t=e._getValueByParamId(i),a=e._getControlByParamId(i);void 0===t||""===t?a.jqxDropDownList("selectIndex",-1):a.jqxDropDownList("selectItem",t);};},e.prototype.createRadioButtonRenderer=function(t){var e=this,i=t.id;return function(){var t=e._getValueByParamId(i),a=e._getControlByParamId(i);a[t]&&a[t].jqxRadioButton({checked:!0});};},e.prototype.createCheckBoxRenderer=function(t){var e=this,i=t.id;return function(){var t=e._getValueByParamId(i),a=e._getControlByParamId(i);if(void 0!==t)for(var r in a){$.inArray(a[r].data("tag"),t)>-1?a[r].jqxCheckBox({checked:!0}):a[r].jqxCheckBox({checked:!1});}else for(var r in a){a[r].jqxCheckBox({checked:!1});}};},e.prototype.createExpressionRenderer=function(t){var e=this,i=t.id;return function(){var t=e._getValueByParamId(i)||"";e._getControlByParamId(i).setValue(t);};},t.VA.Implementation.DataFlow.UdfInvokeControlRenderer=e;}.call(this),function(){"use strict";var t=this.Brightics,e=t.VA.Implementation.DataFlow.Editors,i=this.__module__.EventEmitter,a=this.__module__.ClassUtils,r=this.__module__._,o={count:{start:"${=}",end:"${=}","index-variable":""},collection:{collection:"${=}","element-variable":"","index-variable":""},while:{expression:"${=}","index-variable":""}};function n(t,e){var i=e||{};this.$parent=t,this.conditionHeader=i.conditionHeader,this.loopHeader=i.loopHeader,this.editor=i.editor,this.conditionContext=[],this.activeHeader=void 0,this.init();}a.inherits(n,i),n.prototype.getHeader=function(){return this.header;},n.prototype.init=function(e){this.editor.getCommandManager().registerCallback(function(t){if("Add Condition"!==t.options.label&&"Remove Condition"!==t.options.label||"header"!==t.options.view)"header"===t.options.view&&this.model&&this._setHeader(this.model,this.fnUnit);else if(this.model)this._setHeader(this.model,this.fnUnit);else{var e=this.fnUnit.param.if.mid;this.editor.getModelLayoutManager().changeEditorModel(e);}}.bind(this)),this.editor.getCommandManager().registerGoHistoryCallback(function(t){r.findIndex(t.options.commands,function(t){return"Add Condition"===t.options.label||"Remove Condition"===t.options.label;})>-1&&this._setHeader(this.model,this.fnUnit);}.bind(this)),this.conditionHeader.on("tab-add-click",function(e){var i=t.VA.Core.Utils.IDGenerator.model.id(),a=new t.VA.Core.CompoundCommand(this,{label:"Add Condition",view:"header"});a.add(this.createAddParameterCommand(this.fnUnit,{mid:i,conditionType:"elseif"})),a.add(this.createNewActivityCommand(this.fnUnit,{mid:i,conditionType:"elseif"})),this.editor.getCommandManager().execute(a);}.bind(this)),this.conditionHeader.on("tab-close-click",function(e){if("elseif"===e.data.getType()){var i=new t.VA.Core.CompoundCommand(this,{label:"Remove Condition",view:"header"});i.add(this.createRemoveActivityCommand(this.fnUnit,{mid:e.data.getId()})),i.add(this.createRemoveParameterCommand(this.fnUnit,{mid:e.data.getId(),conditionType:"elseif"})),this.editor.getCommandManager().execute(i);}}.bind(this)),this.conditionHeader.on("tab-click",function(t){this.emit("tab-click",t);}.bind(this)),this.conditionHeader.on("field-change",function(t){this.editor.getCommandManager().execute(this.createConditionFieldChangeCommand(t));}.bind(this)),this.loopHeader.on("input-change",function(t){var e={val:t.value,path:t.path};this.editor.getCommandManager().execute(this.createLoopFieldChangeCommand(this.fnUnit,e));}.bind(this)),this.loopHeader.on("type-change",function(t){var e={loopType:t};this.editor.getCommandManager().execute(this.createLoopTypeChangeCommand(this.fnUnit,e));}.bind(this));},n.prototype.setModel=function(t,e,i){this.editor.getDiagramEditorPage().setModel(t),this._setHeader(t,e,i),this.model=t,this.fnUnit=e,e&&(this.conditionContext=e.param),Studio.getInstance().doValidate(t);},n.prototype._setHeader=function(t,e){if(!e)return this.conditionHeader.hide(),this.loopHeader.hide(),this.editor.getHeaderArea().hide(),void(this.activeHeader=void 0);var i=t.mid;if("If"===e[FUNCTION_NAME])this.editor.getHeaderArea().show(),this.conditionHeader.setData(e.param),this.conditionHeader.show(),this.conditionHeader.render(),this.conditionHeader.selectTab(i),this.loopHeader.hide(),this.activeHeader=this.conditionHeader;else{if("ForLoop"!==e[FUNCTION_NAME]&&"WhileLoop"!==e[FUNCTION_NAME])throw this.activeHeader=void 0,new Error("unexpected fnunit");this.editor.getHeaderArea().show(),this.loopHeader.setData(e),this.loopHeader.render(!0),this.conditionHeader.hide(),this.loopHeader.hide(),this.activeHeader=this.loopHeader;}},n.prototype.createConditionFieldChangeCommand=function(e){var i=["param"];if("if"===e.type)i.push("if");else{if("elseif"!==e.type)return;i.push("elseif");var a=r.findIndex(this.fnUnit.param.elseif,function(t){return t.mid===e.id;});if(-1===a)return;i.push(a);}i.push("expression");var o={fnUnit:this.fnUnit,label:"Condition Field Update",path:i,value:e.field,view:"header"};return new t.VA.Core.Editors.Diagram.Commands.UpdateOperationCommand(this,o);},n.prototype.createNewActivityCommand=function(e,i){var a=function(t,e){return"if"===t.func?{mid:e.mid,type:t.func,conditionType:e.conditionType}:"forLoop"===t.func||"whileLoop"===t.func?{mid:t.param.mid,type:"loop"}:void 0;}(e,i);return new t.VA.Core.Editors.Diagram.Commands.NewActivityCommand(this,a);},n.prototype.createAddParameterCommand=function(e,i){var a=i._conditionType||"elseif",r=i.mid,o=["param",a],n={expression:"true",mid:r},s=function(){if("elseif"===a){if(!e.param.elseif)return[n];o.push(e.param.elseif.length);}return n;}();return new t.VA.Core.Editors.Diagram.Commands.AddOperationCommand(this,{fnUnit:e,path:o,value:s});},n.prototype.createRemoveActivityCommand=function(e,i){return new t.VA.Core.Editors.Diagram.Commands.RemoveActivityCommand(this,{mid:i.mid});},n.prototype.createRemoveParameterCommand=function(e,i){var a=i._conditionType||"elseif";if("elseif"===a){var o=["param",a],n=r.findIndex(e.param.elseif,function(t){return t.mid===i.mid;});if(-1!==n)return o.push(n),new t.VA.Core.Editors.Diagram.Commands.RemoveOperationCommand(this,{fnUnit:e,path:o});}},n.prototype.getHeaderHeight=function(){return this.activeHeader?this.activeHeader.getHeight():0;},n.prototype.setLayoutManager=function(t){this.layoutManager=t;},n.prototype.createLoopFieldChangeCommand=function(e,i){var a={label:"Loop Field Update",fnUnit:e,path:["param"].concat(i.path),value:i.val,view:"header"};return new t.VA.Core.Editors.Diagram.Commands.UpdateOperationCommand(this,a);},n.prototype.createLoopTypeChangeCommand=function(e,i){var a=new t.VA.Core.CompoundCommand(this,{label:"Loop Type Changed",view:"header"});return a.add(new t.VA.Core.Editors.Diagram.Commands.UpdateOperationCommand(this,{fnUnit:e,path:["param","type"],value:i.loopType})),a.add(new t.VA.Core.Editors.Diagram.Commands.UpdateOperationCommand(this,{fnUnit:e,path:["param","prop"],value:r.cloneDeep(o[i.loopType])})),a;},e.Diagram.DiagramEditorWrapper=n;}.call(this),function(){"use strict";var t=this.Brightics,e=this.__module__.ClassUtils,i=this.__module__.EventEmitter;function a(){}e.inherits(a,i),a.prototype.show=function(){this.$el.show(),this.onShow();},a.prototype.hide=function(){this.$el.hide();},a.prototype.getHeight=function(){return this.$el.outerHeight();},a.prototype.onShow=function(){},t.VA.Implementation.DataFlow.Editors.Header.Header=a;}.call(this),function(){"use strict";var t=this.Brightics,e=this.__module__.ClassUtils,i=this.__module__.EventEmitter,a={field:"brtc-condition-header-field",labelWrapper:"brtc-condition-header-field-label-wrapper",textareaWrapper:"brtc-condition-header-field-textarea-wrapper",textarea:"brtc-condition-header-field-textarea",hide:"brtc-condition-header-field-hide",textareaLabel:"brtc-condition-header-field-textarea-label"};function r(t,e){var i=e||{},r=this;this.$parent=t,this.fieldContext=i.context,this.prvVal=this.fieldContext?this.fieldContext.getField():"${=}",this.$expandArrow=$(crel("i",{class:"fa fa-chevron-down brtc-condition-header-field-expand-arrow","aria-hidden":"true"})),this.isExpanded=!1,this.$expandArrow.click(function(){r.isExpanded=!r.isExpanded,r.render();}),this.$el=$(crel("div",{class:a.field},this.$expandArrow[0],crel("div",{class:a.labelWrapper},crel("label",{class:a.textareaLabel},"Condition")),crel("div",{class:a.textareaWrapper},crel("textarea",{class:a.textarea})))),this.$textArea=this.$el.find("."+a.textarea),this.wrappedTextArea=this.createWrappedTextArea(this.$textArea),this.wrappedTextArea.change(function(t){this.prvVal!==t&&(this.prvVal=t,this.fieldContext.setField(t),this.emit("field-change",{id:this.fieldContext.getId(),type:this.fieldContext.getType(),field:t}));}.bind(this)),this.$parent.append(this.$el);}e.inherits(r,i),r.prototype.setContext=function(t){return this.fieldContext=t,this;},r.prototype.getContext=function(){return this.fieldContext;},r.prototype.render=function(){this.wrappedTextArea.setValue(this.fieldContext?this.fieldContext.getField():"${=}"),this.isExpanded?(this.$textArea.removeClass("brtc-condition-header-field-textarea-unexpanded"),this.$el.addClass("brtc-condition-header-field-expanded"),this.$expandArrow.removeClass("fa-chevron-down"),this.$expandArrow.addClass("fa-chevron-up")):(this.$textArea.addClass("brtc-condition-header-field-textarea-unexpanded"),this.$el.removeClass("brtc-condition-header-field-expanded"),this.$expandArrow.removeClass("fa-chevron-up"),this.$expandArrow.addClass("fa-chevron-down")),this.wrappedTextArea.expand(this.isExpanded),this.wrappedTextArea.refresh();},r.prototype.show=function(){this.$el.removeClass(a.hide),this.wrappedTextArea.refresh();},r.prototype.hide=function(){this.$el.addClass(a.hide);},r.prototype.createWrappedTextArea=function(t){var e,i=_.merge({},{mode:"brtc-control",scrollbarStyle:"null",lineWrapping:!1,matchBrackets:!1,extraKeys:{"Ctrl-Space":"autocomplete",Tab:!1,"Shift-Tab":!1},showTrailingSpace:!0}),a=CodeMirror.fromTextArea(t[0],i),r=this,o=(e=a,{setValue:function setValue(t){var i=function(t){var e=_.isUndefined(t)?"":t;return r.test(e)?e.substring(3,e.length-1):e;}(t);e.setValue(i),e.refresh();},getValue:function getValue(){return"${="+e.getValue()+"}";},change:function change(t){e.on("blur",function(e){e.state.focused&&t(o.getValue());});},expand:function expand(t){t?e.setSize(null,"200px"):(e.setSize(null,"30px"),e.setCursor(1),e.scrollTo(null,0)),e.refresh();},refresh:function refresh(){e.refresh();}});return o;},r.prototype.wrap=function(t){return"${="+(t||"")+"}";},r.prototype.test=function(t){return _.startsWith(t,"${=")&&_.endsWith(t,"}");},t.VA.Implementation.DataFlow.Editors.Header.ConditionHeaderField=r;}.call(this),function(){"use strict";var t=this.Brightics,e=this.__module__.ClassUtils,i=this.__module__.EventEmitter,a=this.__module__._,r=t.VA.Implementation.DataFlow.Editors.Header;function o(t,e){var i=e||{};this.$template=$(['<div class="brtc-condition-header-tab-bar">','  <div class="brtc-condition-header-tab-bar-list">',"  </div>",'  <div class="brtc-condition-header-tab-bar-add">',"+","  </div>","</div>"].join("\n")),this.$tabListArea=this.$template.find(".brtc-condition-header-tab-bar-list"),this.$addBtn=this.$template.find(".brtc-condition-header-tab-bar-add"),this.$addBtn.click(this._handleAddClick.bind(this)),this.$parent=t,this.$parent.append(this.$template),this.tabContextList=i.tabContextList||[],this.uselectedTabId=0;}e.inherits(o,i),o.prototype.addTabContext=function(t){this.tabContextList.push(t);},o.prototype.removeTabContext=function(t){this.tabContextList.splice(t,1);},o.prototype.setTabContextList=function(t){this.tabContextList=t;},o.prototype.getTabContextList=function(){return this.tabContextList;},o.prototype.render=function(){var t=this;this.$tabListArea.empty(),this.tabRefList=a.map(this.tabContextList,function(e){return t._newTab(t.$tabListArea,e,t.selectedTabId==e.getId());});},o.prototype._getTabById=function(t){var e=a.findIndex(this.tabContextList,function(e){return e.getId()==t;});return e>-1?this.tabRefList[e]:null;},o.prototype.selectTab=function(t){if(t!=this.selectedTabId){a.forEach(this.tabRefList,function(t){return t.unselect();}),this.unselectTab();var e=this._getTabById(t);return e&&(this.selectedTabId=t,e.select()),!0;}},o.prototype.closeTab=function(t){if(!this._isValidIndex(t))return!1;this.removeTabContext(t);var e=this.tabContextList.length>t?t:this.tabContextList.length-1;return-1==e?this.unselectTab():this.selectTab(e),!0;},o.prototype.unselectTab=function(){return this.selectedTabId=-1,!0;},o.prototype._newTab=function(t,e,i){var a=this,o=new r.ConditionHeaderTab(t,{tabContext:e,selected:i});return o.on("tab-click",function(t){a.selectTab(t.data.getId()),a.emit("tab-click",t);}),o.on("tab-close-click",function(t){a.emit("tab-close-click",t);}),o;},o.prototype._handleAddClick=function(t){this.emit("tab-add-click",t);},r.ConditionHeaderTabBar=o;}.call(this),function(){"use strict";var t=this.Brightics.VA.Implementation.DataFlow.Editors.Header;function e(t){var e=t||{};this.id=e.id,this.title=e.title||"untitled",this.field=e.field||"true",this.type=e.type;}e.prototype.getId=function(){return this.id;},e.prototype.getTitle=function(){return this.title;},e.prototype.setTitle=function(t){return this.title=t,this;},e.prototype.getField=function(){return this.field;},e.prototype.setField=function(t){return this.field=t,this;},e.prototype.getType=function(){return this.type;},t.ConditionHeaderTabContext=e;}.call(this),function(){"use strict";var t=this.Brightics,e=this.__module__.ClassUtils,i=this.__module__.EventEmitter,a={tab:"brtc-condition-header-tab",title:"brtc-condition-header-tab-title",closeBtn:"brtc-condition-header-tab-close-btn",tabSelected:"brtc-condition-header-tab-selected"};function r(t,e){var i=e||{};this.$parent=t,this.tabContext=i.tabContext,this.selected=i.selected||!1,this.$el=$("<div/>",{class:a.tab}),this.$titleArea=$("<div/>",{class:a.title}),this.$closeButton=$("<div/>",{class:a.closeBtn}),this.$el.append(this.$titleArea),this.selected&&this.select(),this.$titleArea.html(this.tabContext.getTitle()),this.$titleArea.click(function(t){this.emit("tab-click",{data:this.tabContext});}.bind(this)),"elseif"==this.tabContext.getType()&&(this.$el.append(this.$closeButton),this.$closeButton.click(function(t){t.stopPropagation(),this.emit("tab-close-click",{data:this.tabContext});}.bind(this))),this.$parent.append(this.$el);}e.inherits(r,i),r.prototype.select=function(){this.$el.addClass(a.tabSelected);},r.prototype.unselect=function(t){this.$el.removeClass(a.tabSelected);},t.VA.Implementation.DataFlow.Editors.Header.ConditionHeaderTab=r;}.call(this),function(){"use strict";var t=this.Brightics,e=this.__module__.ClassUtils,i=t.VA.Implementation.DataFlow.Editors.Header,a=this.__module__._;function r(t,e){var a=e||{};i.Header.call(this,t,a),this.$parent=t,this.$el=$("<div/>",{class:"brtc-condition-header"}),this.$el.hide(),this.$tabBarArea=$("<div/>",{class:"brtc-condition-header-tab-bar-area"}),this.$el.append(this.$tabBarArea),this.conditionTabBar=new i.ConditionHeaderTabBar(this.$tabBarArea,{tabContextList:this.tabContextList}),this.conditionTabBar.on("tab-add-click",this._handleAddTabClick.bind(this)),this.conditionTabBar.on("tab-close-click",this._handleCloseTabClick.bind(this)),this.conditionTabBar.on("tab-click",this._handleTabClick.bind(this)),this.$parent.append(this.$el),this.hide();}e.inherits(r,i.Header),r.prototype.render=function(){this.conditionTabBar.setTabContextList(this.tabContextList),this.conditionTabBar.render();},r.prototype.selectTab=function(t){this.conditionTabBar.selectTab(t),this.selectedTabId=t;},r.prototype.unselectTab=function(){this.getSelectedTabContext().unselect();},r.prototype._handleTabClick=function(t){return this.selectedTabId=t.data.getId(),this.emit("tab-click",t),!0;},r.prototype._handleAddTabClick=function(t){return this.emit("tab-add-click",t),!0;},r.prototype._handleCloseTabClick=function(t){return this.emit("tab-close-click",t),!0;},r.prototype._handleFieldChange=function(t){this.emit("field-change",t);},r.prototype.setData=function(t){this.data=t,this.tabContextList=this._toTabContext(t);},r.prototype._toTabContext=function(t){var e=[];return e.push(new i.ConditionHeaderTabContext({id:t.if.mid,title:"If",type:"if",field:t.if.expression})),e=e.concat(a.map(t.elseif,function(t,e){return new i.ConditionHeaderTabContext({id:t.mid,title:"Else-If("+e+")",type:"elseif",field:t.expression});})),t.else&&e.push(new i.ConditionHeaderTabContext({id:t.else.mid,title:"Else",type:"else"})),e;},r.prototype._getTabContextById=function(t){var e=a.findIndex(this.tabContextList,function(e){return e.getId()===t;});return e>-1?this.tabContextList[e]:null;},r.prototype.getSelectedTabContext=function(){return this._getTabContextById(this.selectedTabId);},r.prototype.getSelectedConditionId=function(){return this.selectedTabId;},i.ConditionHeader=r;}.call(this),function(){"use strict";var t=this.Brightics,e=this.__module__.ClassUtils,i=this.__module__.EventEmitter,a={HEADER_FIELD:"brtc-loop-header-field",LOOP_CONDITION_WRAPPER:"brtc-loop-header-loop-condition",LABEL_INPUT_PAIR_WRAPPER:"brtc-loop-header-label-input-pair-wrapper",READONLY_LABEL:"brtc-loop-header-readonly-label",READONLY_INPUT:"brtc-loop-header-readonly-input",READONLY_LABEL_INPUT_PAIR_WRAPPER:"brtc-loop-header-readonly-label-input-pair-wrapper",EXPAND:"brtc-loop-header-expand",LABEL_DIV:"brtc-loop-header-label-div",FLEX_VERTICAL_CENTER:"brtc-style-display-flex brtc-style-align-items-center"},r={forLoop:["count","collection"],whileLoop:["while"]};function o(t){var e=this;this.$parent=t,this.loopType="",this.valueMap={},this.$wrapper={},this.$radio={},this.$input={},this.isExpanded=!0,this.$expand=$(crel("div",{class:a.EXPAND})),this.$expandArrow=$(crel("i",{class:"fa fa-chevron-up brtc-loop-header-expand-arrow","aria-hidden":"true"})),this.$expand.append(this.$expandArrow),this.$expand.click(function(){e.isExpanded=!e.isExpanded,e.render();}),this.$radioArea=$(crel("div",{class:a.LABEL_INPUT_PAIR_WRAPPER},crel("div",{class:a.LABEL_DIV},"Loop Type",crel("div",{class:"brtc-va-editors-sheet-controls-propertycontrol-mandatory"},"*")),crel("div",{class:a.FLEX_VERTICAL_CENTER},this._createRadioButton("Count","count"),this._createRadioButton("Collection","collection"),this._createRadioButton("While","while")))),this.$expandedDiv=$(crel("div",{class:"brtc-loop-header-expanded"},this.$radioArea[0])),this.$unexpandedDiv=$(crel("div",{class:"brtc-loop-header-unexpanded"})),this.$el=$(crel("div",{class:a.HEADER_FIELD},this.$expand[0],this.$expandedDiv[0],this.$unexpandedDiv[0])),this.$wrapper.count=$(crel("div",this._createLabelInputPair("Start","brtc-loop-header-count-start","start",!0,"count",!0),this._createLabelInputPair("End","brtc-loop-header-count-end","end",!0,"count",!0),this._createLabelInputPair("Index Variable","brtc-loop-header-count-index-variable","index-variable",!1,"count"))),this.$wrapper.collection=$(crel("div",this._createLabelInputPair("Collection","brtc-loop-header-collection-collection","collection",!0,"collection",!0),this._createLabelInputPair("Element Variable","brtc-loop-header-collection-element-variable","element-variable",!1,"collection"),this._createLabelInputPair("Index Variable","brtc-loop-header-collection-index-variable","index-variable",!1,"collection"))),this.$wrapper.while=$(crel("div",this._createLabelInputPair("Expression","brtc-loop-header-while-expression","expression",!0,"while",!0),this._createLabelInputPair("Index Variable","brtc-loop-header-while-index-variable","index-variable",!1,"while"))),_.forIn(this.$wrapper,function(t){this.$expandedDiv.append(t);}.bind(this)),this.$parent.append(this.$el),this.changeLayout();}e.inherits(o,i),o.prototype.setData=function(t){var e=this;this.fnUnit=t;var i=t.param;this.props=i,this.loopType=i.type,this.valueMap={},_.forIn(i.prop,function(t,i){e.valueMap[e.getKey(e.loopType,i)]=t;}),this.changeLayout();},o.prototype.changeLayout=function(){var t=this;_.forIn(this.$radio,function(t){t.hide();}),_.forIn(this.$wrapper,function(t){t.hide();});var e=this.getLoopFunc(),i=0;_.forEach(r[e],function(e){t.$radio[e].show(),t.$wrapper[e].show(),++i;}),1===i?t.$radioArea.hide():t.$radioArea.show(),this.refresh();},o.prototype.render=function(t){var e=this;if(this.$radio[this.loopType].jqxRadioButton({checked:!0}),this._showWrapper(this.loopType),_.forIn(this.props.prop,function(t,i){var a=e.getKey(e.loopType,i);_.has(e.$input,a)&&e.$input[a].setValue(t);}),this.isExpanded)this.$expandedDiv.show(),this.$unexpandedDiv.hide(),this.$expandArrow.removeClass("fa-chevron-down"),this.$expandArrow.addClass("fa-chevron-up");else{this.$unexpandedDiv.empty();var i={count:{label:"Count",props:[{label:"Start",key:"start",exp:!0},{label:"End",key:"end",exp:!0},{label:"Index Variable",key:"index-variable",exp:!1}]},collection:{label:"Collection",props:[{label:"Collection",key:"collection",exp:!0},{label:"Element Variable",key:"element-variable",exp:!1},{label:"Index Variable",key:"index-variable",exp:!1}]},while:{label:"While",props:[{label:"Expression",key:"expression",exp:!0},{label:"Index Variable",key:"index-variable",exp:!1}]}},a=this.loopType,r=[e._createLabelInputPairReadOnly("Loop Type",i[a].label)];r=r.concat(_.map(i[a].props,function(t){return e._createLabelInputPairReadOnly(t.label,e.props.prop[t.key],t.exp);})),this.$unexpandedDiv.append(r),this.$expandedDiv.hide(),this.$unexpandedDiv.show(),this.$expandArrow.removeClass("fa-chevron-up"),this.$expandArrow.addClass("fa-chevron-down");}this.refresh();},o.prototype.createCodeMirrorInput=function(e,i,a,r){var o,n,s=this,l=_.merge({},{mode:"brtc-control",scrollbarStyle:"null",lineWrapping:!1,matchBrackets:!1,extraKeys:{"Ctrl-Space":"autocomplete",Tab:!1,"Shift-Tab":!1},showTrailingSpace:!0},i),c=CodeMirror.fromTextArea(e[0],l),d=(o=r,n=c,{setValue:function setValue(t){var e=function(t,e){var i=t||"";return o&&s.test(i)?i.substring(3,i.length-1):i;}(t);n.setValue(e),a(d.getValue());},getValue:function getValue(){var t=n.getValue();return o?"${="+t+"}":t;},refresh:function refresh(){n.refresh();}});return t.VA.Core.Utils.WidgetUtils.changeCodeMirrorLineToSingle(c),c.on("blur",function(){a(d.getValue());}),d;},o.prototype._createLabelInputPairReadOnly=function(e,i,r){var o=i||"";r&&this.test(o)&&(o=o.substring(3,o.length-1));var n=$(crel("input",{class:a.READONLY_INPUT,value:o,title:o})).jqxInput({theme:t.VA.Env.Theme,readOnly:!0});return crel("div",{class:a.READONLY_LABEL_INPUT_PAIR_WRAPPER},crel("label",{class:a.READONLY_LABEL},e),n[0]);},o.prototype._createLabelInputPair=function(t,e,i,r,o,n){var s=r?"Enter Expression":"Enter Variable",l=r?"100%":"97%",c=$(crel("textarea",{class:e+" brtc-va-widget-contents-input-control"})),d=this,p=crel("div",{class:a.LABEL_INPUT_PAIR_WRAPPER},crel("div",{class:a.LABEL_DIV},t,n?crel("div",{class:"brtc-va-editors-sheet-controls-propertycontrol-mandatory"},"*"):""),crel("span",c[0])),h=$(crel("div",{class:"brtc-va-editors-sheet-panels-validation-tooltip-wrapper"},crel("i",{class:"fa fa-exclamation-triangle","aria-hidden":"true"}),crel("div",{class:"brtc-va-editors-sheet-panels-validation-tooltip"},"'"+t+"' is required parameter.")));return this.$input[d.getKey(o,i)]=this.createCodeMirrorInput(c,{placeholder:s,width:l,height:"25px"},function(t){var e=t,a=r?d.strip(e):e;""===_.trim(a)&&n?($(p).after(h),h.show()):($(p).after(h),h.hide()),e!==(d.valueMap[d.getKey(o,i)]||"")&&(d.valueMap[d.getKey(o,i)]=e,d.emit("input-change",{value:e,path:["prop",i]}));},r),p;},o.prototype._createRadioButton=function(e,i){var a=this;return this.$radio[i]=$(crel("div",{class:"brtc-loop-header-field-radiobutton"},e)).jqxRadioButton({theme:t.VA.Env.Theme,groupName:"type"}),this.$radio[i].bind("checked",function(t){a.loopType!==i&&(a._showWrapper(i),a.valueMap={},a.loopType=i,_.forIn(a.$input,function(t){t.setValue("");}),a.emit("type-change",i));}),this.$radio[i][0];},o.prototype._showWrapper=function(t){_.forIn(this.$wrapper,function(t){t.hide();}),this.$wrapper[t].show(),this.refresh();},o.prototype.getLoopFunc=function(){return this.fnUnit?this.fnUnit.func:"forLoop";},o.prototype.refresh=function(){var t=this,e=this.loopType;this.props&&_.forIn(this.props.prop,function(i,a){var r=t.getKey(e,a);_.has(t.$input,r)&&t.$input[r].refresh();});},o.prototype.getKey=function(t,e){return t+"_"+e;},o.prototype.test=function(t){return _.startsWith(t,"${=")&&_.endsWith(t,"}");},o.prototype.strip=function(t){var e=t||"";return this.test(e)?e.substring(3,e.length-1):e;},t.VA.Implementation.DataFlow.Editors.Header.LoopHeaderField=o;}.call(this),function(){"use strict";var t=this.Brightics,e=this.__module__.ClassUtils,i=t.VA.Implementation.DataFlow.Editors.Header;function a(t,e){this.$parent=t,this.$el=$(['<div class="brtc-loop-header">','  <div class="brtc-loop-header-field-wrapper">',"  </div>","</div>"].join("")),this.data={},this.$loopHeaderField=this.$el.find(".brtc-loop-header-field-wrapper"),this.createField(this.$loopHeaderField),this.$parent.append(this.$el),this.hide();}e.inherits(a,i.Header),a.prototype.createField=function(t){var e=this;this.field=new i.LoopHeaderField(t,{}),this.field.on("input-change",function(t){e.emit("input-change",t);}),this.field.on("type-change",function(t){e.emit("type-change",t);});},a.prototype.setData=function(t){this.data=t,this.field.setData(t);},a.prototype.render=function(){this.field.render();},a.prototype.onShow=function(){this.field.render();},i.LoopHeader=a;}.call(this),function(){"use strict";var t=this.Brightics;function e(e,i){t.VA.Core.Editors.Toolbar.call(this,e,i);}e.prototype=Object.create(t.VA.Core.Editors.Toolbar.prototype),e.prototype.constructor=e,e.prototype.registerItems=function(){var e=t.VA.Implementation.DataFlow.Toolbar.ItemsTemplate;for(var i in e){this.addItem(e[i]);}},t.VA.Implementation.DataFlow.Toolbar=e;}.call(this),function(){"use strict";var t=this.Brightics;function e(e,i){t.VA.Core.Editors.Toolbar.FunctionhelpItem.call(this,e,i);}e.prototype=Object.create(t.VA.Core.Editors.Toolbar.FunctionhelpItem.prototype),e.prototype.constructor=e,e.prototype.handleOnClick=function(e){t.VA.Core.Utils.ModelUtils.openFunctionReferencePopup("data");},t.VA.Implementation.DataFlow.Toolbar.FunctionhelpItem=e;}.call(this),function(){"use strict";var t=this.Brightics;function e(e,i){t.VA.Core.Editors.Toolbar.RunItem.call(this,e,i);}e.prototype=Object.create(t.VA.Core.Editors.Toolbar.RunItem.prototype),e.prototype.constructor=e,e.prototype.handleOnClick=function(e){var i=Studio.getEditorContainer().getActiveModelEditor(),a=i.getModel(),r=function r(t){t.OK&&i.preProcess().then(function(e){Studio.getJobExecutor().launchModel(a,t.args,{runnable:e});});};if("true"===t.VA.SettingStorage.getValue("editor.variable.visible")&&Object.keys(a.variables).length>0)new t.VA.Core.Dialogs.RunDataDialog(this.$mainControl,{close:r,analyticsModel:a});else{var o={};for(var n in a.variables){var s,l=a.variables[n];s=_.isArray(l.value)&&1===l.value.length?l.value[0]:l.value,_.isUndefined(s)||(o[n]=l.value);}r({OK:!0,args:o});}},t.VA.Implementation.DataFlow.Toolbar.RunItem=e;}.call(this),function(){"use strict";var t=this.Brightics;t.VA.Implementation.DataFlow.Toolbar.ItemsTemplate=[{class:t.VA.Implementation.DataFlow.Toolbar.RunItem},{class:t.VA.Core.Editors.Toolbar.Separator},{class:t.VA.Core.Editors.Toolbar.VariableItem},{class:t.VA.Core.Editors.Toolbar.Separator},{class:t.VA.Core.Editors.Toolbar.ClipboardItem},{class:t.VA.Core.Editors.Toolbar.HistoryItem},{class:t.VA.Core.Editors.Toolbar.RedoItem},{class:t.VA.Core.Editors.Toolbar.UndoItem},{class:t.VA.Core.Editors.Toolbar.Separator},{class:t.VA.Core.Editors.Toolbar.ZoomItem},{class:t.VA.Core.Editors.Toolbar.Separator},{class:t.VA.Core.Editors.Toolbar.MoveModeItem},{class:t.VA.Core.Editors.Toolbar.TooltipItem},{class:t.VA.Core.Editors.Toolbar.Separator},{class:t.VA.Core.Editors.Toolbar.DatasourceItem},{class:t.VA.Core.Editors.Toolbar.ScheduleItem},{class:t.VA.Core.Editors.Toolbar.VersionItem},{class:t.VA.Core.Editors.Toolbar.Separator},{class:t.VA.Implementation.DataFlow.Toolbar.FunctionhelpItem},{class:t.VA.Core.Editors.Toolbar.ModelInfoItem}];}.call(this),function(){"use strict";var t=this.Brightics;this.Brightics.VA.Implementation.DataFlow.Utils.AddonFunctionUtil={addFunction:function addFunction(e){var i="string"==typeof e.contents?JSON.parse(e.contents):e.contents,a=e.id;if(!1!==i.isFunction&&!t.VA.Implementation.DataFlow.Functions[a]){var r={category:i.category,defaultFnUnit:{func:a,name:i.name,param:{},display:{label:i.label,diagram:{position:{x:20,y:10}},sheet:{}},meta:i.meta},description:i.description,tags:i.tags,"in-range":i.inrange,"out-range":i.outrange},o={partial:[{panel:[],layout:{}}],full:[{panel:[],layout:{}}]};e.script_id&&(r.defaultFnUnit.param.script={metadata:"script",scriptId:e.script_id}),i.context&&(r.defaultFnUnit.context=i.context),i.version&&(r.defaultFnUnit.version=i.version),"3.6"===i.version&&i.inputs&&JSON.stringify(i.inputs)!==JSON.stringify({})?(r.defaultFnUnit.display.sheet.in=o,r.defaultFnUnit.inputs=i.inputs,r.defaultFnUnit.meta=i.meta):i.inrange&&0!==i.inrange.min&&0!==i.inrange.max&&(r.defaultFnUnit.display.sheet.in=o,i.inputs?r.defaultFnUnit.inputs=$.extend(!0,{},i.inputs):r.defaultFnUnit.inData=[]),"3.6"===i.version&&i.outputs&&JSON.stringify(i.outputs)!==JSON.stringify({})?(r.defaultFnUnit.display.sheet.out=o,r.defaultFnUnit.outputs=i.outputs,r.defaultFnUnit.meta=i.meta):i.outrange&&0!==i.outrange.min&&0!==i.outrange.max&&(r.defaultFnUnit.display.sheet.out=o,i.outputs?r.defaultFnUnit.outputs=$.extend(!0,{},i.outputs):r.defaultFnUnit.outData=[]),i.deprecated&&(r.deprecated=i.deprecated,r["deprecated-message"]=i["deprecated-message"]||"");var n=(i.specJson?i.specJson.params:i.params)||[];r=this._setDefaultValues(r,n),t.VA.Core.Functions.Library[a]=$.extend(!0,{},r),t.VA.Implementation.DataFlow.Functions[a]=$.extend(!0,{},r),t.VA.Implementation.DataFlow.Functions[a].propertiesPanel=this.createPropertiesPanel(i.params),t.VA.Implementation.DataFlow.Functions[a].validator=this.createValidator(i);}},_setDefaultValues:function _setDefaultValues(t,e){var i;if(e)for(var a=0;a<e.length;a++){if(void 0!==(i=e[a]).defaultValue)t.defaultFnUnit.param[i.id]=i.defaultValue;else if(i.items&&i.items.length>0){var _e=i.items.filter(function(t){return!!t.default;}).reduce(function(t,e){return[].concat(t,[e.value]);},[]);1===_e.length&&["BooleanRadio","RadioButton"].some(function(t){return t===i.control;})?t.defaultFnUnit.param[i.id]=_e[0]:"CheckBox"===i.control&&_e.length>0?t.defaultFnUnit.param[i.id]=_e:_e.length>1&&(t.defaultFnUnit.param[i.id]=_e);}}return t;},createPropertiesPanel:function createPropertiesPanel(e){function i(e,i){t.VA.Implementation.DataFlow.Functions.BaseInvokeProperties.call(this,e,i);}return i.prototype=Object.create(t.VA.Implementation.DataFlow.Functions.BaseInvokeProperties.prototype),i.prototype.constructor=i,i.prototype._getParams=function(){return e;},i;},createValidator:function createValidator(e){function i(e,i){t.VA.Implementation.DataFlow.Functions.InvokeValidator.call(this,e,i);}return i.prototype=Object.create(t.VA.Implementation.DataFlow.Functions.InvokeValidator.prototype),i.prototype.constructor=i,i.prototype._getContents=function(){return e;},i.prototype._hasInData=function(){return!!(e.inrange&&e.inrange.min&&e.inrange.min>0)||!!_.isEmpty(e.inputs);},i;}};}.call(this),function(){"use strict";var t,e,i=this.Brightics;this.Brightics.VA.Implementation.DataFlow.Utils.RunnableFactory=(t=function t(_t,e){var a=function a(t){"Subflow"===t[FUNCTION_NAME]&&(t.param.functions=_.map(t.param.functions,a));var i=_.filter(e,function(e){return e.fid===t.fid;});return _.forEach(i,function(e){_.forIn(e.param,function(e,i){t.param[i]="${="+e+"}";});}),t;},r=function r(e){e.functions=_.map(e.functions,a);var o=i.VA.Core.Utils.NestedFlowUtils.getChildModels(_t,e);_.forEach(o,r);};return r(_t);},e=function e(t){var e=function e(t){t.functions=_.map(t.functions,function(t){var e=i.VA.Core.Utils.WidgetUtils.getFunctionLibrary("data",t.func).category;return t.skip="brightics"===e&&t.skip,t;});};e(t),_.forIn(t.innerModels,e);},{createForUnit:function createForUnit(a,r,o,n,s){var l=$.extend(!0,{},a);i.VA.Core.Utils.ModelUtils.carvePersist(l,!0),i.VA.Core.Utils.ModelUtils.deleteEmptyArray(l);var c=a.parent(),d=c.mid,p=c.getMainModel(),h=_.cloneDeep(p.variables),u=_.cloneDeep(p.variableRef),m=i.VA.Core.Utils.NestedFlowUtils.getAllSubModelsFromFnUnit(p,a).map(function(t){var e={};return e[t.mid]=t,e;}),f=_.cloneDeep(_.reduce(m,_.merge,{})),v=_.cloneDeep(p.optModels),b={mid:d,type:"data",variables:h,functions:[l],links:[],innerModels:f,optModels:v,title:c.title};return i.VA.Core.Utils.ModelUtils.extendModel(b),i.VA.Core.Utils.ModelUtils.exportAsRunnablePromise(p,b).then(function(a){var r=i.VA.Core.Utils.ModelUtils.exportAsRunnable(b);return a.models[b.mid]=r,_.forIn(n,function(t,e){r.variables[e]&&(r.variables[e].value=t);}),r.variableRef=u,_.forIn(a.models,function(e){t(e,e.variableRef);}),e(r),a.main=d,i.OptModelManager.buildOptRunnable(a);}).catch(console.error);},createForFlow:function createForFlow(a,r,o,n,s){var l=_.cloneDeep(a),c=l.getMainModel(),d=_.cloneDeep(c.variables),p=_.cloneDeep(c.variableRef);return i.VA.Core.Utils.ModelUtils.exportAsRunnablePromise(c,l).then(function(a){(l=a.models[a.main]).variables=d;var r=i.VA.Core.Utils.ModelUtils.exportAsRunnable(l);return a.models[a.main]=r,e(r),r.variableRef=p,_.forIn(a.models,function(e){t(e,e.variableRef);}),_.forIn(n,function(t,e){r.variables[e]&&(r.variables[e].value=t);}),i.OptModelManager.buildOptRunnable(a);}).catch(console.error);}});}.call(this),function(){"use strict";var t=this.Brightics;function e(e){t.VA.Core.Tools.Manager.SideBarManager.call(this,e);}e.prototype=Object.create(t.VA.Core.Tools.Manager.SideBarManager.prototype),e.prototype.constructor=e,e.prototype.configureLayout=function(){this.layout={variables:{id:"variables",label:"Variables",position:"left",width:330,manager:this},palette:{id:"palette",label:"Palette",position:"right",width:440,manager:this},returnTable:{id:"returnTable",label:"Return Data",position:"right",width:330,manager:this},inputTable:{id:"inputTable",label:"Input Data",position:"left",width:330,manager:this},outline:{id:"outline",label:"Outline",position:"left",width:330,manager:this},optSetting:{id:"optSetting","description-label":"Optimization",label:"Optimization Setting",position:"right",width:367,manager:this}};},e.prototype.createControls=function(){this.sideBar.variables=new t.VA.Core.Tools.SideBar.VariablesSideBar(this.$parent.find(".brtc-va-studio-sidebar[name=variables]"),this.layout.variables),this.sideBar.palette=new t.VA.Core.Tools.SideBar.PaletteSideBar(this.$parent.find(".brtc-va-studio-sidebar[name=palette]"),this.layout.palette),this.sideBar.returnTable=new t.VA.Core.Tools.SideBar.ReturnTableSideBar(this.$parent.find(".brtc-va-studio-sidebar[name=returnTable]"),this.layout.returnTable),this.sideBar.inputTable=new t.VA.Core.Tools.SideBar.InputTableSideBar(this.$parent.find(".brtc-va-studio-sidebar[name=inputTable]"),this.layout.inputTable),this.sideBar.outline=new t.VA.Core.Tools.SideBar.OutlineSideBar(this.$parent.find(".brtc-va-studio-sidebar[name=outline]"),this.layout.outline),this.sideBar.optSetting=new t.VA.Core.Tools.SideBar.OptSettingSideBar(this.$parent.find(".brtc-va-studio-sidebar[name=optSetting]"),this.layout.optSetting);},e.prototype.onActivated=function(){this.sideBar.palette.onActivated();},e.prototype.refresh=function(){this.sideBar.outline.refresh();},e.prototype.updateStatus=function(t){this.sideBar.outline.updateStatus(t);},t.VA.Implementation.DataFlow.Tools.Manager.SideBarManager=e;}.call(this),function(){"use strict";var t=this.Brightics.VA.Implementation.DataFlow,e=t.Clazz,i=this.Brightics.VA.Core.Interface;i.Clazz[e]=e,i.Label[e]=t.Label,i.Validator[e]=t.Validator,i.Editor[e]=t.Editor,i.Toolbar[e]=t.Toolbar,i.SideBarManager[e]=t.Tools.Manager.SideBarManager,i.Launcher[e]=t.DataFlowLauncher,i.Functions[e]=t.Functions,i.WidgetUtils[e]=t.Utils.WidgetUtils,i.DefaultModel[e]=t.defaultModel,i.AddonFunctionUtil[e]=t.Utils.AddonFunctionUtil,i.ProjectContextMenuList[e]=["duplicate","export","deploy","exportAsRunnable","version"],i.Clipboard[e]=!0,i.ModelLayoutManager[e]=t.ModelLayoutManager,i.RunnableFactory[e]=t.Utils.RunnableFactory;}.call(this);