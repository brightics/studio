<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" charset="UTF-8">
    <base href="<%- baseUrl %>" target="_blank">

    <title>Brightics Visual Analytics</title>
    <link href="favicon.ico" rel="icon" type="image/x-icon">

    <script src="js/plugins/babel-polyfill/polyfill.js"></script>
    <script src="js/plugins/css.escape/css.escape.js"></script>

    <link type="text/css" rel="stylesheet" href="css/plugins/normalize.css/normalize.css">
    <link type="text/css" rel="stylesheet" href="font-awesome/4.5.0/css/font-awesome.min.css">
    <!--<link type="text/css" rel="stylesheet" href="css/plugins/bootstrap-3.3.7/bootstrap.min.css">-->
    <link type="text/css" rel="stylesheet" href="css/plugins/aui-package/aui-widgets-1.12.20.min.css">
    <link type="text/css" rel='stylesheet' href='css/plugins/aui-package/aui-widgets-1.9.0.office.css'/>
    <link type="text/css" rel='stylesheet' href='css/plugins/joint/joint.css'/>

    <!-- perfect-scrollbar css -->
    <link type="text/css" rel='stylesheet' media='not print' href='css/plugins/perfect-scrollbar/perfect-scrollbar.css'/>

    <!-- jquery-ui css -->
    <link type="text/css" rel='stylesheet' href='css/plugins/jquery-ui/jquery-ui.css'/>

    <!-- summernote css -->
    <link type="text/css" rel='stylesheet' href='css/plugins/summernote-0.8.2/summernote.css'/>


    <!-- brightics chart css -->
    <link type="text/css" rel="stylesheet" href="css/plugins/bchart/bchart.css">
    <link type="text/css" rel="stylesheet" href="css/plugins/bchart/bchart-vs.css">
    <link type="text/css" rel="stylesheet" href="css/plugins/bchart/bchart.controlcontainer.css">
    <link type="text/css" rel="stylesheet" href="css/va/bchart-va.css">
    <link type="text/css" rel="stylesheet" href="css/va/bchart-vs-va.css">

    <!-- brightics chart css -->
    <link type="text/css" rel="stylesheet" href="css/plugins/bcharts/bcharts-all.css">
    <link type="text/css" rel="stylesheet" href="css/plugins/bcharts/bcharts-adonis-all.css">

    <link type="text/css" rel='stylesheet' href='css/va/brightics-va.css'/>

    <!-- CodeMirror css -->
    <link type="text/css" rel="stylesheet" href="css/plugins/codemirror/codemirror.css">
    <link type="text/css" rel="stylesheet" href="css/plugins/codemirror/addon/hint/show-hint.css">
    <link type="text/css" rel="stylesheet" href="css/plugins/codemirror/addon/scroll/simplescrollbars.css">
    <link type="text/css" rel="stylesheet" href="css/plugins/codemirror/brtc-va-codemirror.css">

    <!-- Handsontable css -->
    <link type="text/css" rel='stylesheet' href='/css/plugins/handsontable/handsontable.full.min.css'/>
    
    <!-- jQuery JS -->
    <script src="js/plugins/jquery/jquery-3.3.1.min.js"></script>
    <script src="js/plugins/jquery-hotkeys/jquery.hotkeys.js"></script>
    <script src="js/plugins/jquery-cookie/jquery.cookie.js"></script>
    <!-- jquery-ui  -->
    <script src="js/plugins/jquery-ui/jquery-ui.min.js"></script>
    <!-- bootstrap JS -->
    <script src="js/plugins/bootstrap-3.3.7-dist/bootstrap.min.js"></script>

    <script src="js/plugins/numeral/numeral.min.js"></script>

    <!-- AUI -->
    <script src="js/plugins/aui-package/globalization/globalize.js"></script>
    <script src="js/plugins/aui-package/aui-core-1.6.4.min.js"></script>
    <script src="js/plugins/aui-package/aui-widgets-1.12.20.min.js"></script>

    <!-- slimscroll JS -->
    <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

    <!-- perfect-scrollbar JS -->
    <script src="js/plugins/perfect-scrollbar/perfect-scrollbar.js"></script>
    <script src="js/plugins/perfect-scrollbar/perfect-scrollbar.jquery.js"></script>

    <!-- joint JS -->
    <script src="js/plugins/lodash/lodash.min.js"></script>
    <script src="js/plugins/backbone/backbone-min.js"></script>
    <script src="js/plugins/joint/joint.js"></script>

    <!-- moment.js -->
    <script src="js/plugins/jquery/moment.min.js"></script>

    <!-- CodeMirror JS -->
    <script src="js/plugins/codemirror/codemirror.js"></script>
    <script src="js/plugins/codemirror/addon/hint/show-hint.js"></script>
    <script src="js/plugins/codemirror/addon/hint/sql-hint.js"></script>
    <script src="js/plugins/codemirror/addon/hint/anyword-hint.js"></script>
    <script src="js/plugins/codemirror/addon/hint/brtc-custom-hint.js"></script>
    <script src="js/plugins/codemirror/addon/hint/scala-custom-hint.js"></script>
    <script src="js/plugins/codemirror/addon/edit/matchbrackets.js"></script>
    <script src="js/plugins/codemirror/addon/edit/closebrackets.js"></script>
    <script src="js/plugins/codemirror/addon/edit/trailingspace.js"></script>
    <script src="js/plugins/codemirror/addon/scroll/simplescrollbars.js"></script>
    <script src="js/plugins/codemirror/mode/javascript/javascript.js"></script>
    <script src="js/plugins/codemirror/mode/sql/sql.js"></script>
    <script src="js/plugins/codemirror/mode/clike/clike.js"></script>
    <script src="js/plugins/codemirror/mode/r/r.js"></script>
    <script src="js/plugins/codemirror/simple.js"></script>
    <script src="js/plugins/codemirror/display/placeholder.js"></script>
    <script src="js/plugins/codemirror/mode/python/python.js"></script>
    <!-- jsPDF -->
    <script src="js/plugins/jspdf/jspdf.min.js"></script>

    <!-- html2canvas -->
    <script src="js/plugins/html2canvas/html2canvas.js"></script>
    <script src="js/plugins/html2canvas/html2canvas.svg.js"></script>

    <!-- jsbn-RSA -->
    <script type="text/javascript" src="js/plugins/jsbn-rsa/jsbn.js"></script>
    <script type="text/javascript" src="js/plugins/jsbn-rsa/prng4.js"></script>
    <script type="text/javascript" src="js/plugins/jsbn-rsa/rng.js"></script>
    <script type="text/javascript" src="js/plugins/jsbn-rsa/rsa.js"></script>
    <script type="text/javascript" src="js/plugins/jsbn-rsa/base64.js"></script>

    <!-- summernote -->
    <script src="js/plugins/summernote-0.8.2/summernote.js"></script>

    <!-- Ace Editor -->
    <script src="js/plugins/ace/ace.js"></script>
    <script src="js/plugins/ace/ext-language_tools.js"></script>

    <!-- EChart JS -->
    <script src="js/plugins/echarts/echarts.js"></script>
    <script src="js/plugins/echarts-stat/ecStat.js"></script>

    <!-- D3.js v4-->
    <script src="js/plugins/d3/d3.js"></script>
    <script src="js/plugins/d3-tip/index.js"></script>

    <!-- jStat -->
    <script src="js/plugins/jstat/jstat.js"></script>

    <!-- Handsontable -->
    <script src="/js/plugins/handsontable/handsontable.full.min.js"></script>
    
    <!-- Brightics Core -->
    <script src="js/va/brightics-va-core.js"></script>

    <!-- Functions -->
    <script src="js/va/brightics-va-functions.js"></script>

    <!-- Bchart -->
    <!--<script src="js/plugins/bchart/bchart-all.js"></script>-->
    <!--<script src="js/plugins/bchart-vs/bchart.vs.component.js"></script>-->

    <!-- Bcharts -->
    <script src="js/plugins/bcharts/bcharts-all.js"></script>
    <script src="js/plugins/bcharts/bcharts-adonis-all.js"></script>
    <script src="js/plugins/bcharts/bcharts-module-all.js"></script>

    <!-- Brightics Modules -->
    <script src="js/va/brightics-va-dataflow.js"></script>
    <script src="js/va/brightics-va-controlflow.js"></script>
    <!--<script src="js/va/brightics-va-realtime.js"></script>-->
    <!--<script src="js/va/brightics-va-etlflow.js"></script>-->
    <script src="js/va/brightics-va-visual.js"></script>
    <script src="js/va/brightics-va-script.js"></script>


    <!--<script src="http://localhost:3001/js/plugins/bchart-vs-component/dist/bchart.vs.component.js"></script>-->
    <style>
        html, body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            print-color-adjust: exact;
            -webkit-print-color-adjust: exact;
        }
        body > .ps-scrollbar-x-rail, body > .ps-scrollbar-y-rail {
            z-index: 1;
        }
        .brtc-style-content-wrapper, .brtc-style-page .brtc-style-content-wrapper.ui-selected {
            outline: none !important;
        }
        .ui-resizable-handle.ui-resizable-se.ui-icon.ui-icon-gripsmall-diagonal-se {
            display: none !important;
        }
        @page {
            margin: 0px;
            page-break-before:avoid;
            page-break-after:avoid;
        }
        .hide-splitter {
            display: none;
        }
        .brtc-va-editors-visualeditor-page-wrapper-splitter {
            height: 30px;
        }
        @media print {
            .brtc-va-editors-visualeditor-page-wrapper-splitter {
                height: 0px;
            }
            .brtc-va-visual-page {
                box-shadow: unset;
            }
            html, body {
                -webkit-print-color-adjust: exact;
            }
            .bcharts-container {
                line-height: 200%;
                height: calc(100% - 30px);
            }
            .brtc-style-editor-visualeditorpage-export-pdf-paper-container {
                height: auto;
                left: 0px;
                top: 0px;
                position: absolute;
            }
            .brtc-va-visual-page {
                margin: 0;
                page-break-before:avoid;
                page-break-after:avoid;
            }
            .brtc-va-editors-visualeditor-page-wrapper{
                line-height: 0px;
            }
            .brtc-va-editor-visualeditor-export-pdf-button,
            .jqx-scrollbar,
            .ps-scrollbar-x-rail, .ps-scrollbar-y-rail,
            header, footer,
            #header, #Nav, #FlyOutNav, #SubNav, .NoPrint, p.CodeAlert, #SMLinks, #SearchForm {
                display: none;
            }
        }
        .note-editable.panel-body,
        .note-editable.panel-body *:before,
        .note-editable.panel-body *:after{
            color: #000 !important;
            text-shadow: none !important;
            background: #fff !important;
            -webkit-box-shadow: none !important;
            box-shadow: none !important;
            box-sizing: border-box !important;
        }
        a,
        a:visited {
            text-decoration: underline;
        }
        a[href]:after {
            content: " (" attr(href) ")";
        }
        abbr[title]:after {
            content: " (" attr(title) ")";
        }
        a[href^="#"]:after,
        a[href^="javascript:"]:after {
            content: "";
        }
        pre,
        blockquote {
            border: 1px solid #999;
            page-break-inside: avoid;
        }
        thead {
            display: table-header-group;
        }
        tr,
        img {
            page-break-inside: avoid;
        }
        img {
            max-width: 100% !important;
        }
        p,
        h2,
        h3 {
            orphans: 3;
            widows: 3;
        }
        h2,
        h3 {
            page-break-after: avoid;
        }
        .navbar {
            display: none;
        }
        .btn > .caret,
        .dropup > .btn > .caret {
            border-top-color: #000 !important;
        }
        .label {
            border: 1px solid #000;
        }
        .table {
            border-collapse: collapse !important;
        }
        .table td,
        .table th {
            background-color: #fff !important;
        }
        .table-bordered th,
        .table-bordered td {
            border: 1px solid #ddd !important;
        }
        h1,
        .h1 {
            font-size: 36px;
        }
        h2,
        .h2 {
            font-size: 30px;
        }
        h3,
        .h3 {
            font-size: 24px;
        }
        h4,
        .h4 {
            font-size: 18px;
        }
        h5,
        .h5 {
            font-size: 14px;
        }
        h6,
        .h6 {
            font-size: 12px;
        }
        p {
            margin: 0 0 10px;
        }
        button,
        input,
        optgroup,
        select,
        textarea {
        margin: 0;
        font: inherit;
        color: inherit;
        }
        @media print {
        /** {
          color: #000 !important;
          text-shadow: none !important;
          background: transparent !important;
          -webkit-box-shadow: none !important;
                  box-shadow: none !important;
        } */
}
    </style>
</head>
<body>
<div class="brtc-va-main-export-pdf jqx-widget-content jqx-widget-content-office">
    <div class="brtc-va-progress" style="width:100%;height:100%">
        <div>
            <span class="brtc-va-progress-loading"></span>
        </div>
    </div>
</div>
</body>
<script>

    // ChartContentUnit 에서 바로 사용을 함. ExportPDFView에서는 Studio를 생성하지 않음
    var Studio;
    window.onload = function () {
        setTimeout(function () {
            var getParameterByName = function (name, url) {
                name = name.replace(/[\[\]]/g, "\\$&");
                var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                        results = regex.exec(url);
                if (!results) return null;
                if (!results[2]) return '';
                return decodeURIComponent(results[2].replace(/\+/g, " "));
            };
            var exportPDFOptions = {
                user: getParameterByName('user', window.location.href),
                pid: getParameterByName('pid', window.location.href),
                mid: getParameterByName('mid', window.location.href)
            };
            Brightics.VA.Env.Session.userId = exportPDFOptions.user;
            Brightics.VA.Env.Session.logLevel = '<%- logLevel %>';
            new Brightics.VA.Implementation.Visual.ExportPDFView($(".brtc-va-main-export-pdf"), exportPDFOptions);

            $('.brtc-va-visual-content-wrapper.brtc-style-content-wrapper').off('mousedown');
            $('.brtc-va-visual-content-wrapper.brtc-style-content-wrapper').resizable('destroy');
        }, 3000)

    };
</script>
</html>
