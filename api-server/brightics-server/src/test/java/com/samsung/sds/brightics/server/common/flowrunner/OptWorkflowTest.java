/*
    Copyright 2019 Samsung SDS
    
    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at
    
        http://www.apache.org/licenses/LICENSE-2.0
    
    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
*/

package com.samsung.sds.brightics.server.common.flowrunner;

import org.junit.Test;

import com.samsung.sds.brightics.common.core.util.JsonUtil;
import com.samsung.sds.brightics.server.common.flowrunner.status.JobContextHolder;
import com.samsung.sds.brightics.server.model.param.JobParam;

public class OptWorkflowTest {

	@Test
	public void optflowtest(){
	
		String jsonString3 = "{\"main\":\"mn24htywhmfx3dfz\",\"models\":{\"mn24htywhmfx3dfz\":{\"variables\":{},\"variableRef\":[],\"innerModels\":{},\"inData\":[],\"outData\":[],\"type\":\"data\",\"param\":{},\"functions\":[{\"func\":\"load\",\"name\":\"Subflow\",\"outData\":[\"taa3mnuwxt4j2saj\"],\"param\":{\"functions\":[{\"fid\":\"faphx32qmdj92xer\",\"func\":\"load\",\"name\":\"InOutData\",\"outData\":[\"taa3mnuwxt4j2saj\"],\"param\":{\"io-mode\":\"read\",\"fs-type\":\"alluxiocsv\",\"df-names\":[\"taa3mnuwxt4j2saj\"],\"fs-paths\":[\"\test\"]},\"persist\":true,\"label\":\"Load\"}],\"entries\":[\"faphx32qmdj92xer\"]},\"fid\":\"furc2tr9y43bg4cy\",\"persist-mode\":\"auto\",\"label\":\"Load\",\"persist\":true,\"skip\":false},{\"func\":\"conditionFilter\",\"name\":\"Filter\",\"inData\":[\"taa3mnuwxt4j2saj\"],\"outData\":[\"t483avfrrr7tvpt2\"],\"param\":{\"condition\":[[\"[Species]\",\"==\",\"setosa\",\"\"]]},\"fid\":\"f9day8fb7bh6ksg9\",\"persist-mode\":\"auto\",\"label\":\"Filter\",\"persist\":true,\"skip\":false},{\"func\":\"linearRegressionTrain\",\"name\":\"LinearRegressionTrain\",\"inData\":[\"t483avfrrr7tvpt2\"],\"outData\":[\"tsd9uuh2bmwz3grd\",\"t56ucpehy367hqc2\",\"tkk2gt6bfmpgp8gb\"],\"param\":{\"ycolumn\":[[\"SepalLength\"]],\"xcolumns\":[[\"SepalWidth\"]],\"types\":\"0.0\",\"intercept\":\"true\",\"iteration\":\"100\",\"regularization\":\"0.01\",\"tolerance\":\"0.000001\"},\"fid\":\"fdqdwafhqab4v8x8\",\"persist-mode\":\"auto\",\"label\":\"Linear Regression Train\",\"persist\":true,\"skip\":false},{\"func\":\"linearRegressionPredict\",\"name\":\"LinearRegressionPredict\",\"inData\":[\"tsd9uuh2bmwz3grd\"],\"outData\":[\"t5378e746wnhvttf\"],\"param\":{\"columns\":[[\"SepalWidth\"]],\"hold-columns\":[[\"SepalLength\",\"PetalWidth\",\"Species\"]],\"types\":\"0.0\",\"intercept\":\"true\",\"iteration\":\"100\",\"regularization\":\"0.01\"},\"fid\":\"f3jzm4cmpa2yujcq\",\"persist-mode\":\"auto\",\"label\":\"Linear Regression Predict\",\"persist\":true,\"skip\":false},{\"func\":\"regressionEvaluation\",\"name\":\"EvaluateRegression\",\"inData\":[\"t5378e746wnhvttf\"],\"outData\":[\"tvbtjqg48muf45yj\"],\"param\":{\"predict-column\":[[\"predict\"]],\"value-column\":[[\"SepalLength\"]]},\"fid\":\"f88759ujbet3nat6\",\"persist-mode\":\"auto\",\"label\":\"Evaluate Regression\",\"persist\":true,\"skip\":false},{\"fid\":\"mvhpntczcq2bwa5y\",\"label\":\"opt model\",\"name\":\"Opt\",\"param\":{\"mid\":\"mvhpntczcq2bwa5y\"}},{\"fid\":\"m8rgrgqan377yp4q\",\"label\":\"opt model\",\"name\":\"Opt\",\"param\":{\"mid\":\"m8rgrgqan377yp4q\"}}],\"links\":[{\"kid\":\"k8h9t4nmd59j3pas\",\"sourceFid\":\"furc2tr9y43bg4cy\",\"targetFid\":\"f9day8fb7bh6ksg9\"},{\"kid\":\"k88wvcdmjb8ugfgv\",\"sourceFid\":\"fdqdwafhqab4v8x8\",\"targetFid\":\"f3jzm4cmpa2yujcq\"},{\"kid\":\"k9v86wt29uyqnx2s\",\"sourceFid\":\"f3jzm4cmpa2yujcq\",\"targetFid\":\"f88759ujbet3nat6\"},{\"sourceFid\":\"f9day8fb7bh6ksg9\",\"targetFid\":\"mvhpntczcq2bwa5y\"},{\"sourceFid\":\"mvhpntczcq2bwa5y\",\"targetFid\":\"fdqdwafhqab4v8x8\"},{\"sourceFid\":\"mvhpntczcq2bwa5y\",\"targetFid\":\"fdqdwafhqab4v8x8\"}],\"mid\":\"mn24htywhmfx3dfz\",\"title\":\"DF01\",\"description\":\"Iris description sample\",\"gv-def\":{},\"gv\":[],\"persist-mode\":\"auto\",\"diagram\":{\"PAPER_MARGIN_TOP\":20,\"PAPER_MARGIN_LEFT\":20,\"FIGURE_WIDTH\":195,\"FIGURE_HEIGHT\":60,\"GAP_WIDTH\":55,\"GAP_HEIGHT\":40},\"optModels\":{\"mvhpntczcq2bwa5y\":{\"optId\":\"mvhpntczcq2bwa5y\",\"label\":\"opt model\",\"description\":\"description\",\"createTime\":1532325879405,\"creator\":\"hoon.im@samsung.com\",\"updateTime\":1532325879405,\"updater\":\"hoon.im@samsung.com\",\"options\":{\"activated\":\"true\",\"useSavedModel\":\"false\"},\"functions\":[{\"func\":\"linearRegressionTrain\",\"name\":\"LinearRegressionTrain\",\"inData\":[\"t483avfrrr7tvpt2\"],\"outData\":[\"tsd9uuh2bmwz3grd\",\"t56ucpehy367hqc2\",\"tkk2gt6bfmpgp8gb\"],\"param\":{\"ycolumn\":[[\"SepalLength\"]],\"xcolumns\":[[\"SepalWidth\"]],\"types\":\"0.0\",\"intercept\":\"true\",\"iteration\":\"100\",\"regularization\":\"0.01\",\"tolerance\":\"0.000001\"},\"fid\":\"fdqdwafhqab4v8x8\",\"persist-mode\":\"auto\",\"label\":\"Linear Regression Train\",\"persist\":true,\"skip\":false},{\"func\":\"conditionFilter\",\"name\":\"Filter\",\"inData\":[\"taa3mnuwxt4j2saj\"],\"outData\":[\"t483avfrrr7tvpt2\"],\"param\":{\"condition\":[[\"[Species]\",\"==\",\"setosa\",\"\"]]},\"fid\":\"f9day8fb7bh6ksg9\",\"persist-mode\":\"auto\",\"label\":\"Filter\",\"persist\":true,\"skip\":false}],\"links\":[],\"optSelected\":{\"fdqdwafhqab4v8x8\":{\"optParam\":{\"regularization\":{\"min\":0,\"max\":10,\"value\":0.01,\"type\":\"Double\"},\"types\":{\"min\":0,\"max\":1,\"value\":0,\"type\":\"Double\"}}}}},\"m8rgrgqan377yp4q\":{\"optId\":\"m8rgrgqan377yp4q\",\"label\":\"opt model\",\"description\":\"description\",\"createTime\":1532325882658,\"creator\":\"hoon.im@samsung.com\",\"updateTime\":1532325882658,\"updater\":\"hoon.im@samsung.com\",\"options\":{\"activated\":\"true\",\"useSavedModel\":\"false\"},\"functions\":[{\"func\":\"regressionEvaluation\",\"name\":\"EvaluateRegression\",\"inData\":[\"t5378e746wnhvttf\"],\"outData\":[\"tvbtjqg48muf45yj\"],\"param\":{\"predict-column\":[[\"predict\"]],\"value-column\":[[\"SepalLength\"]]},\"fid\":\"f88759ujbet3nat6\",\"persist-mode\":\"auto\",\"label\":\"Evaluate Regression\",\"persist\":true,\"skip\":false},{\"func\":\"linearRegressionPredict\",\"name\":\"LinearRegressionPredict\",\"inData\":[\"tsd9uuh2bmwz3grd\"],\"outData\":[\"t5378e746wnhvttf\"],\"param\":{\"columns\":[[\"SepalWidth\"]],\"hold-columns\":[[\"SepalLength\",\"PetalWidth\",\"Species\"]],\"types\":\"0.0\",\"intercept\":\"true\",\"iteration\":\"100\",\"regularization\":\"0.01\"},\"fid\":\"f3jzm4cmpa2yujcq\",\"persist-mode\":\"auto\",\"label\":\"Linear Regression Predict\",\"persist\":true,\"skip\":false}],\"links\":[],\"optSelected\":{\"fdqdwafhqab4v8x8\":{\"optParam\":{\"regularization\":{\"min\":0,\"max\":10,\"value\":0.01,\"type\":\"Double\"},\"types\":{\"min\":0,\"max\":1,\"value\":0,\"type\":\"Double\"}}}}}},\"entries\":[\"furc2tr9y43bg4cy\"]}},\"version\":\"3.5\"}";
		String jsonString2= "{\"main\":\"mfbaqfxvvay5wydr\",\"models\":{\"mfbaqfxvvay5wydr\":{\"variables\":{\"variable1\":{\"type\":\"string\",\"value\":\"setosa\"}},\"variableRef\":[],\"innerModels\":{},\"inData\":[],\"outData\":[],\"type\":\"data\",\"param\":{},\"functions\":[{\"persist-mode\":\"auto\",\"func\":\"load\",\"name\":\"Subflow\",\"outData\":[\"td6y7txy3tp2b5u3\"],\"param\":{\"functions\":[{\"fid\":\"ftemqejdnqfvum29\",\"func\":\"load\",\"name\":\"InOutData\",\"outData\":[\"td6y7txy3tp2b5u3\"],\"param\":{\"io-mode\":\"read\",\"fs-type\":\"alluxiocsv\",\"df-names\":[\"td6y7txy3tp2b5u3\"],\"fs-paths\":[\"test\"]},\"persist\":true,\"label\":\"Load\"}],\"entries\":[\"ftemqejdnqfvum29\"]},\"fid\":\"fj5bb96u7w939pbn\",\"label\":\"Load\",\"persist\":true,\"skip\":false},{\"persist-mode\":\"auto\",\"func\":\"conditionFilter\",\"name\":\"Filter\",\"inData\":[\"td6y7txy3tp2b5u3\"],\"outData\":[\"t3jj378epsdtttjb\"],\"param\":{\"regularization\":\"11111\",\"types\":\"${=variable1}\"},\"fid\":\"fe6jgyueyjvpgn4z\",\"label\":\"Filter\",\"persist\":true,\"skip\":false},{\"fid\":\"mw4et2bq6batug4g\",\"label\":\"opt model\",\"name\":\"Opt\",\"param\":{\"mid\":\"mw4et2bq6batug4g\"}}],\"links\":[{\"sourceFid\":\"fj5bb96u7w939pbn\",\"targetFid\":\"mw4et2bq6batug4g\"},{\"sourceFid\":\"mw4et2bq6batug4g\",\"targetFid\":\"fe6jgyueyjvpgn4z\"}],\"mid\":\"mfbaqfxvvay5wydr\",\"title\":\"DF03\",\"persist-mode\":\"auto\",\"optModels\":{\"mw4et2bq6batug4g\":{\"optId\":\"mw4et2bq6batug4g\",\"label\":\"opt model\",\"options\":{\"option1\":\"value1\",\"option2\":\"value2\",\"option3\":\"value3\"},\"optSelected\":{\"fe6jgyueyjvpgn4z\":{\"optParam\":{\"regularization\":{\"min\":10,\"max\":10000,\"value\":\"11111\",\"type\":\"string\"},\"types\":{\"min\":10,\"max\":10000,\"value\":\"${=variable1}\",\"type\":\"string\"}}}},\"functions\":[{\"fid\":\"fe6jgyueyjvpgn4z\",\"name\":\"Filter\",\"inData\":[\"td6y7txy3tp2b5u3\"],\"outData\":[\"t3jj378epsdtttjb\"],\"param\":{\"regularization\":\"11111\",\"types\":\"${=variable1}\"},\"label\":\"Filter\",\"persist\":true,\"skip\":false}],\"links\":[]}},\"entries\":[\"fj5bb96u7w939pbn\"]}},\"version\":\"3.5\"}";
		String jsonString = "{\"main\":\"mfbaqfxvvay5wydr\",\"models\":{\"mfbaqfxvvay5wydr\":{\"variables\":{},\"variableRef\":[],\"innerModels\":{},\"inData\":[],\"outData\":[],\"type\":\"data\",\"param\":{},\"functions\":[{\"persist-mode\":\"auto\",\"func\":\"load\",\"name\":\"Subflow\",\"outData\":[\"td6y7txy3tp2b5u3\"],\"param\":{\"functions\":[{\"fid\":\"ftemqejdnqfvum29\",\"func\":\"load\",\"name\":\"InOutData\",\"outData\":[\"td6y7txy3tp2b5u3\"],\"param\":{\"io-mode\":\"read\",\"fs-type\":\"alluxiocsv\",\"df-names\":[\"td6y7txy3tp2b5u3\"],\"fs-paths\":[]},\"persist\":true,\"label\":\"Load\"}],\"entries\":[\"ftemqejdnqfvum29\"]},\"fid\":\"fj5bb96u7w939pbn\",\"label\":\"Load\",\"persist\":true,\"skip\":false},{\"persist-mode\":\"auto\",\"func\":\"scalaScript\",\"name\":\"ScalaScript\",\"inData\":[\"td6y7txy3tp2b5u3\"],\"outData\":[\"t6udqjsg93ksmcz9\"],\"param\":{},\"fid\":\"fp5q498abkyfxvng\",\"label\":\"Scala Script\",\"persist\":true,\"skip\":false},{\"fid\":\"m2nxupde5teapmhh\",\"label\":\"opt model\",\"name\":\"Opt\",\"param\":{\"mid\":\"m2nxupde5teapmhh\"}}],\"links\":[{\"sourceFid\":\"fj5bb96u7w939pbn\",\"targetFid\":\"m2nxupde5teapmhh\"},{\"sourceFid\":\"m2nxupde5teapmhh\",\"targetFid\":\"fp5q498abkyfxvng\"}],\"mid\":\"mfbaqfxvvay5wydr\",\"title\":\"DF03\",\"persist-mode\":\"auto\",\"diagram\":{\"PAPER_MARGIN_TOP\":20,\"PAPER_MARGIN_LEFT\":20,\"FIGURE_WIDTH\":195,\"FIGURE_HEIGHT\":60,\"GAP_WIDTH\":55,\"GAP_HEIGHT\":40},\"optModels\":{\"m2nxupde5teapmhh\":{\"opt-id\":\"m2nxupde5teapmhh\",\"label\":\"opt model\",\"description\":\"description\",\"create-time\":1531902391631,\"creator\":\"hoon.im@samsung.com\",\"update-time\":1531902391631,\"updater\":\"hoon.im@samsung.com\",\"activated\":\"true\",\"use-saved-model\":\"false\",\"functions\":[{\"fid\":\"fp5q498abkyfxvng\",\"opt-selected\":\"none\",\"opt-parameters\":{},\"persist-mode\":\"auto\",\"func\":\"scalaScript\",\"name\":\"ScalaScript\",\"inData\":[\"td6y7txy3tp2b5u3\"],\"outData\":[\"t6udqjsg93ksmcz9\"],\"param\":{},\"label\":\"Scala Script\",\"persist\":true,\"skip\":false}],\"links\":[]}},\"entries\":[\"fj5bb96u7w939pbn\"]}},\"version\":\"3.5\"}";
		JobRunner runner = new JobRunner(JsonUtil.fromJson(jsonString2, JobParam.class));
		JobContextHolder.initialize(runner);
		runner.run();
		
		
		
	}
	
	
}
